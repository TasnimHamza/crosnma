<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Tasnim Hamza" />

<meta name="date" content="2021-06-07" />

<title>Cross-design and cross-data format synthesis using Network Meta-Analysis (crosnma)</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Cross-design and cross-data format synthesis using Network Meta-Analysis (crosnma)</h1>
<h4 class="author">Tasnim Hamza</h4>
<h4 class="date">2021-06-07</h4>


<div id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#the-synthesis-model-of-individual-participant-data-ipd-and-aggregate-data-ad"><span class="toc-section-number">2</span> The synthesis model of individual participant data (IPD) and aggregate data (AD)</a><ul>
<li><a href="#naive-synthesis"><span class="toc-section-number">2.1</span> Naive synthesis</a></li>
<li><a href="#using-nrs-as-a-prior"><span class="toc-section-number">2.2</span> Using NRS as a prior</a></li>
<li><a href="#rob-adjusted-model-1"><span class="toc-section-number">2.3</span> RoB-adjusted model 1</a></li>
<li><a href="#rob-adjusted-model-2"><span class="toc-section-number">2.4</span> RoB-adjusted model 2</a></li>
</ul></li>
<li><a href="#explore-the-network"><span class="toc-section-number">3</span> Explore the network</a><ul>
<li><a href="#check-network-connectivity"><span class="toc-section-number">3.1</span> Check network connectivity</a></li>
<li><a href="#network-characteristics"><span class="toc-section-number">3.2</span> Network characteristics</a></li>
</ul></li>
<li><a href="#the-r-implementation"><span class="toc-section-number">4</span> The R implementation</a><ul>
<li><a href="#naïve-synthesis"><span class="toc-section-number">4.1</span> Naïve synthesis</a></li>
<li><a href="#using-nrs-as-a-prior-1"><span class="toc-section-number">4.2</span> Using NRS as a prior</a></li>
<li><a href="#rob-adjusted-model-1-1"><span class="toc-section-number">4.3</span> RoB-adjusted model 1</a></li>
<li><a href="#rob-adjusted-model-2-1"><span class="toc-section-number">4.4</span> RoB-adjusted model 2</a></li>
</ul></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(crosnma)</a></code></pre></div>
<div id="introduction" class="section level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>Network meta-analysis (NMA) is a common tool to compare multiple interventions simultaneously. This requires synthesize the available evidence that might come as different study design or data format. As different study designs, the evidence can be obtained from non-randomized studies (NRS) or randomized controlled trials (RCT). RCT evidence quality is considered the highest and at a lower risk of bias, however, the restricted settings when RCTs are conducted limit the generalizability of their results. Therefore, combining RCT and NRS evidence in NMA may help overcome some of the limitations. Such evidence can be accessible in different data formats as individual participant data (IPD) or aggregate data (AD). We establish a cross-design and cross-data format package (<code>crosnma</code>) to utilize all available and relevant evidence.</p>
<p>We describe the R package <code>crosnma</code> in a worked example about relapsing remitting multiple sclerosis (RRMS). The primary outcome is the occurrence of relapses in two years (binary outcome, 0/1). In the analysis, the outcome will be expressed as odds ratio (OR). The aim is to compare the efficacy of four treatments. Data is available from 6 different studies in different formats and different designs. The studies are either available as study-level data <code>std.data</code> (2 studies) or as individual participant data <code>prt.data</code> (four studies). Three of the <code>prt.data</code> are RCTs and one comes from an observational study (NRS). The two <code>std.data</code> are RCTs.</p>
<p>The <code>prt.data</code> contains 2950 rows, each refers to a participant in the study. We display the first few rows of the data set:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">head</span>(prt.data)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt;   study outcome trt design age sex bias year</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt; 1     1       0   D    rct  20   1  low 2002</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt; 2     1       0   D    rct  29   0  low 2002</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; 3     1       0   D    rct  35   0  low 2002</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; 4     1       0   D    rct  38   0  low 2002</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; 5     1       0   D    rct  37   0  low 2002</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; 6     1       0   D    rct  32   0  low 2002</span></a></code></pre></div>
<p>For each participant, we have information for the occurrence of the relapses (0=no, 1=yes) <code>outcome</code>, the treatment label <code>trt</code>, the age (in years) <code>age</code> and sex (0 = Female, 1 = Male) <code>sex</code> of the participant. The other following columns are set on study-level (it is repeated for each participant of the study): the study id <code>study</code>, the design of the study ( needs to be either rct or nrs) <code>design</code>, the risk of bias on each study (set as a low, high or unclear) <code>bias</code> and the year of publication <code>year</code>.</p>
<p>We display the full data that is available on study-level:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">head</span>(std.data)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt;   study outcome   n trt design  age sex    bias year</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; 1     1      19  25   A    rct 34.3 0.2     low 2010</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; 2     1      11  25   C    rct 34.3 0.3     low 2010</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; 3     2      97 126   A    rct 30.0 0.4 unclear 2015</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt; 4     2      89 125   C    rct 30.0 0.5 unclear 2015</span></a></code></pre></div>
<p>For all studies, we provide the following information on each arm level: the total number of participants <code>n</code> and the number of those who relapsed <code>outcome</code>, the treatment label <code>trt</code>. At study-level, we have the study id <code>study</code>, the design of the study <code>design</code>, the mean age <code>age</code>, the percentage of males <code>sex</code>, the risk of bias on the study <code>bias</code> and the year of publication <code>year</code>.</p>
</div>
<div id="the-synthesis-model-of-individual-participant-data-ipd-and-aggregate-data-ad" class="section level1">
<h1><span class="header-section-number">2</span> The synthesis model of individual participant data (IPD) and aggregate data (AD)</h1>
<p>We introduce the model to synthesis individual participant data (IPD) and aggregate data (AD). Each data format could come from randomized clinical trials (RCT) or non-randomized studies (NRS). These two designs could be combined in one of four different methods. We describe the four synthesis models for network meta-regression. However, we can run the network meta-analysis by decline the covariates terms from the models. Let’s begin with describing the notations that will be used in the description of the models.</p>
<table>
<colgroup>
<col width="51%"></col>
<col width="30%"></col>
<col width="17%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left">Notation</th>
<th align="left">Description</th>
<th align="left">Argument in <code>crosnma.model()</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(i=1, ..., np_j\)</span></td>
<td align="left">participant id</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(j=1, ..., ns\)</span></td>
<td align="left">study id</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(k=1, ..., K\)</span></td>
<td align="left">treatment index</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(ns_{IPD}, ns_{AD}, ns_{RCT}, ns_{NRS}\)</span></td>
<td align="left">number of studies with index denote the design or format of the study</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(y_{ijk}\)</span></td>
<td align="left">binary outcome (0/1)</td>
<td align="left"><code>outcome</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(p_{ijk}\)</span></td>
<td align="left">probability of the event to occur</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(r_{jk}\)</span></td>
<td align="left">the number of events per arm</td>
<td align="left"><code>outcome</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(n_{jk}\)</span></td>
<td align="left">the sample size per arm</td>
<td align="left"><code>n</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(b\)</span></td>
<td align="left">the study-specific reference</td>
<td align="left">*</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(u_{j}\)</span></td>
<td align="left">The treatment effect of the study-specific reference</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\delta_{jk}\)</span></td>
<td align="left">log(OR) of treatment k relative to <span class="math inline">\(b\)</span></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(x_{ijk}\)</span></td>
<td align="left">the covariate</td>
<td align="left"><code>covariate</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\bar{x}_{j}\)</span></td>
<td align="left">the mean covariate for study <span class="math inline">\(j\)</span></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(d_{Ak}\)</span></td>
<td align="left">the basic parameters, <span class="math inline">\(d_{AA}=0\)</span> (A is the reference in the network)</td>
<td align="left">use <code>reference</code> to assign the reference treatment <span class="math inline">\(A\)</span></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(z_j\)</span></td>
<td align="left">study characteristics to estimate the bias probability <span class="math inline">\(\pi_j\)</span></td>
<td align="left"><code>bias.covariate</code></td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(w_j\)</span></td>
<td align="left">inflation factor of variance for the NRS estimates</td>
<td align="left">the element <code>var.infl</code> in <code>run.nrs</code></td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\vartheta_j\)</span></td>
<td align="left">mean shift of the NRS estimates</td>
<td align="left">the element <code>mean.shift</code> in <code>run.nrs</code></td>
</tr>
</tbody>
</table>
<p>*it is assigned automatically to the reference in the network (<span class="math inline">\(A\)</span>), if it is available on the study. If not, it is assigned automatically to the first alphabetically treatment on the study</p>
<div id="naive-synthesis" class="section level2">
<h2><span class="header-section-number">2.1</span> Naive synthesis</h2>
<p>We synthesis the evidence from RCT and NRS without acknowledging the differences between them. For both of them, we model the IPD data and the AD data as the following.</p>
<p><strong>model IPD only</strong></p>
<p><span class="math display">\[
y_{ijk} \sim Bernoulli(p_{ijk})
\]</span> <span class="math display">\[\begin{equation}
  logit(p_{ijk}) =
    \begin{cases}
      u_j +\beta_{1,j} x_{ijk} &amp; \text{if $k=b$}\\
      u_j +\delta_{jk} + (\beta_{1,j}+\beta^w_{2,jk}) x_{ijk}+
 (\beta^B_{2,jk}-\beta^w_{2,jk}) \bar{x}_{.j} &amp; \text{if $k≠b$}
    \end{cases}       
\end{equation}\]</span></p>
<p><strong>model AD only</strong> <span class="math display">\[
r_{jk} \sim Binomial(p_{jk},n_{jk})
\]</span> <span class="math display">\[\begin{equation}
  logit(p_{jk}) =
    \begin{cases}
      u_j  &amp; \text{if $k=b$}\\
      u_j +\delta_{jk} +\beta^B_{2,jk} \bar{x}_{j} &amp; \text{if $k≠b$}
    \end{cases}       
\end{equation}\]</span></p>
</div>
<div id="using-nrs-as-a-prior" class="section level2">
<h2><span class="header-section-number">2.2</span> Using NRS as a prior</h2>
<p>We run the model in Section 2.1 two consequent times. First we estimate the relative treatment effects only using the NRS (use <code>run.nrs</code> in <code>crosnma.model()</code> to control the process). Second, we use the NRS estimates (<span class="math inline">\(\hat{d}^{NRS}_{Ak},\hat{V}^{NRS}_{Ak}\)</span>) as a prior information for the basic parameters of RCT data, <span class="math inline">\(d_{Ak} \sim N(\hat{d}^{NRS}_{Ak},\hat{V}^{NRS}_{Ak})\)</span>. To control the NRS influence in the RCT estimates, we can either inflate the NRS variance by <span class="math inline">\(w_j\)</span> (the inflated variance is <span class="math inline">\(\hat{V}^{NRS}_{Ak}/w_j\)</span>) or shift the NRS means by <span class="math inline">\(\vartheta\)</span>.</p>
</div>
<div id="rob-adjusted-model-1" class="section level2">
<h2><span class="header-section-number">2.3</span> RoB-adjusted model 1</h2>
<p>We incorporate the risk of bias (RoB) into the IPD and the AD models by adding the bias term <span class="math inline">\(\gamma_j R_j\)</span> to each.</p>
<p><strong>model IPD only</strong></p>
<p><span class="math display">\[
y_{ijk} \sim Bernoulli(p_{ijk})
\]</span> <span class="math display">\[\begin{equation}
  logit(p_{ijk}) =
    \begin{cases}
      u_j +\beta_{1,j} x_{ijk} &amp; \text{if $k=b$}\\
      u_j +\delta_{jk} + (\beta_{1,j}+\beta^w_{2,jk}) x_{ijk}+
 (\beta^B_{2,jk}-\beta^w_{2,jk}) \bar{x}_{.j}+\gamma_j R_j &amp; \text{if $k≠b$}
    \end{cases}       
\end{equation}\]</span></p>
<p><strong>model AD only</strong> <span class="math display">\[
r_{jk} \sim Binomial(p_{jk},n_{jk})
\]</span> <span class="math display">\[\begin{equation}
  logit(p_{jk}) =
    \begin{cases}
      u_j  &amp; \text{if $k=b$}\\
      u_j +\delta_{jk} +
 \beta^B_{2,jk} \bar{x}_{j}+\gamma_j R_j &amp; \text{if $k≠b$}
    \end{cases}       
\end{equation}\]</span></p>
<p>The bias indicator</p>
<p><span class="math display">\[
R_j \sim Bernoulli(\pi_j)
\]</span></p>
</div>
<div id="rob-adjusted-model-2" class="section level2">
<h2><span class="header-section-number">2.4</span> RoB-adjusted model 2</h2>
<p>Another way to incorporate the study RoB is by adding the bias adjusted relative treatment effect <span class="math inline">\(\theta_{jk}\)</span> instead of the unadjusted one <span class="math inline">\(\delta_{jk}\)</span>. Then to model <span class="math inline">\(\theta_{jk}\)</span> by a bi-modal normal distribution as in Table 2 below. We estimate the bias probability <span class="math inline">\(\pi_j\)</span> by either assigning a beta distribution or by using a study characteristics <span class="math inline">\(z_j\)</span> through a logistic transformation.</p>
<p><strong>model IPD only</strong></p>
<p><span class="math display">\[
y_{ijk} \sim Bernoulli(p_{ijk})
\]</span> <span class="math display">\[\begin{equation}
  logit(p_{ijk}) =
    \begin{cases}
      u_j +\beta_{1,j} x_{ijk} &amp; \text{if $k=b$}\\
      u_j +\theta_{jk} + (\beta_{1,j}+\beta^w_{2,jk}) x_{ijk}+
 (\beta^B_{2,jk}-\beta^w_{2,jk}) \bar{x}_{j} &amp; \text{if $k≠b$}
    \end{cases}       
\end{equation}\]</span></p>
<p><strong>model AD only</strong> <span class="math display">\[
r_{jk} \sim Binomial(p_{jk},n_{jk})
\]</span> <span class="math display">\[\begin{equation}
  logit(p_{jk}) =
    \begin{cases}
      u_j &amp; \text{if $k=b$}\\
      u_j +\theta_{jk} +\beta^B_{2,jk} \bar{x}_{j} &amp; \text{if $k≠b$}
    \end{cases}       
\end{equation}\]</span></p>
<p><strong>Combine IPD and AD</strong></p>
<p>The table below summarizes the different assumptions implemented in the package about combining the parameters in the model described the previous section.</p>
<table>
<colgroup>
<col width="54%"></col>
<col width="28%"></col>
<col width="16%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left">Parameter</th>
<th align="left">Assumptions</th>
<th align="left">Argument in <code>crosnma.model()</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">relative treatment effect (<span class="math inline">\(\delta_{jk}\)</span>)</td>
<td align="left">Random-effects: <span class="math inline">\(\delta_{jk} \sim N(d_{Ak}-d_{Ab}, \tau_\delta^2)\)</span></td>
<td align="left"><code>trt.effect='random'</code></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Common-effect: <span class="math inline">\(\delta_{jk}=d_{Ak}-d_{Ab}\)</span></td>
<td align="left"><code>trt.effect='common'</code></td>
</tr>
<tr class="odd">
<td align="left">Covariate effect <span class="math inline">\(\beta_{0, j}\)</span></td>
<td align="left">Independent effects: <span class="math inline">\(\beta_{0, j} \sim N(0, 10^2)\)</span></td>
<td align="left"><code>reg0.effect='independent'</code></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Random-effects: <span class="math inline">\(\beta_{0,j} \sim N(B_0, \tau_{\beta_0})\)</span></td>
<td align="left"><code>reg0.effect='random'</code></td>
</tr>
<tr class="odd">
<td align="left">Within-study covariate-treatment interaction (<span class="math inline">\(\beta_{1, jk}^W\)</span>)</td>
<td align="left">Random-effects: <span class="math inline">\(\beta_{1, jk}^W \sim N(B_{1, Ak}^W-B_{1, Ab}^W, \tau_{\beta_1^W})\)</span></td>
<td align="left"><code>regw.effect='random'</code></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Common-effect: <span class="math inline">\(\beta_{1,jk}^W = B_{1, Ak}^W-B_{1, Ab}^W\)</span></td>
<td align="left"><code>regw.effect='common'</code></td>
</tr>
<tr class="odd">
<td align="left">Between-study covariate-treatment interaction (<span class="math inline">\(\beta_{1, jk}^B\)</span>)</td>
<td align="left">Random-effects: <span class="math inline">\(\beta_{1,jk}^B \sim N(B_{1, Ak}^B-B_{1, Ab}^B, \tau_{\beta_1^B})\)</span></td>
<td align="left"><code>regb.effect='random'</code></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Common-effect: <span class="math inline">\(\beta_{1,jk}^B = B_{1, Ak}^B-B_{1, Ab}^B\)</span></td>
<td align="left"><code>regb.effect='common'</code></td>
</tr>
<tr class="odd">
<td align="left">bias-adjusted relative treatment effect (<span class="math inline">\(\theta_{jk}\)</span>)</td>
<td align="left">Random-effects: <span class="math inline">\(\theta_{jk} \sim (1-\pi_j)N(d_{Ak}-d_{Ab}, \tau_\delta^2) + \pi_jN(d_{Ak}-d_{Ab}+\gamma_j, \tau_\delta^2+\tau_\gamma^2)\)</span></td>
<td align="left"><code>trt.effect='random'</code></td>
</tr>
<tr class="even">
<td align="left">Bias effect (<span class="math inline">\(\gamma_{j}\)</span>)</td>
<td align="left">Random-effects: <span class="math inline">\(\gamma_{j} \sim N(\Gamma, \tau_{\gamma})\)</span></td>
<td align="left"><code>bias.effect='random'</code></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Common-effect: <span class="math inline">\(\gamma_{j} = \Gamma\)</span></td>
<td align="left"><code>bias.effect='common'</code></td>
</tr>
<tr class="even">
<td align="left">Bias probability (<span class="math inline">\(\pi_j\)</span>)</td>
<td align="left"><span class="math inline">\(\pi_j \sim Beta(a,b)\)</span></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left"><span class="math inline">\(\pi_j = a+bz_j\)</span></td>
<td align="left"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="explore-the-network" class="section level1">
<h1><span class="header-section-number">3</span> Explore the network</h1>
<div id="check-network-connectivity" class="section level2">
<h2><span class="header-section-number">3.1</span> Check network connectivity</h2>
<p>The network should be checked for its connectivity before running the analysis. This is a vital step as the model will run even if the network is not connected.</p>
<p><strong>Network plot</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">netplot</span>(prt.data,std.data)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-30" data-line-number="30"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-31" data-line-number="31"></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-33" data-line-number="33"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-34" data-line-number="34"></a>
<a class="sourceLine" id="cb4-35" data-line-number="35"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-36" data-line-number="36"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-37" data-line-number="37"></a>
<a class="sourceLine" id="cb4-38" data-line-number="38"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-39" data-line-number="39"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-40" data-line-number="40"></a>
<a class="sourceLine" id="cb4-41" data-line-number="41"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-42" data-line-number="42"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-43" data-line-number="43"></a>
<a class="sourceLine" id="cb4-44" data-line-number="44"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-45" data-line-number="45"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-46" data-line-number="46"></a>
<a class="sourceLine" id="cb4-47" data-line-number="47"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-48" data-line-number="48"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-49" data-line-number="49"></a>
<a class="sourceLine" id="cb4-50" data-line-number="50"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-51" data-line-number="51"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-52" data-line-number="52"></a>
<a class="sourceLine" id="cb4-53" data-line-number="53"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-54" data-line-number="54"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-55" data-line-number="55"></a>
<a class="sourceLine" id="cb4-56" data-line-number="56"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-57" data-line-number="57"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-58" data-line-number="58"></a>
<a class="sourceLine" id="cb4-59" data-line-number="59"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-60" data-line-number="60"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-61" data-line-number="61"></a>
<a class="sourceLine" id="cb4-62" data-line-number="62"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-63" data-line-number="63"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-64" data-line-number="64"></a>
<a class="sourceLine" id="cb4-65" data-line-number="65"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-66" data-line-number="66"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-67" data-line-number="67"></a>
<a class="sourceLine" id="cb4-68" data-line-number="68"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-69" data-line-number="69"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-70" data-line-number="70"></a>
<a class="sourceLine" id="cb4-71" data-line-number="71"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-72" data-line-number="72"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-73" data-line-number="73"></a>
<a class="sourceLine" id="cb4-74" data-line-number="74"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-75" data-line-number="75"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-76" data-line-number="76"></a>
<a class="sourceLine" id="cb4-77" data-line-number="77"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-78" data-line-number="78"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-79" data-line-number="79"></a>
<a class="sourceLine" id="cb4-80" data-line-number="80"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-81" data-line-number="81"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-82" data-line-number="82"></a>
<a class="sourceLine" id="cb4-83" data-line-number="83"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-84" data-line-number="84"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-85" data-line-number="85"></a>
<a class="sourceLine" id="cb4-86" data-line-number="86"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-87" data-line-number="87"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-88" data-line-number="88"></a>
<a class="sourceLine" id="cb4-89" data-line-number="89"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-90" data-line-number="90"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-91" data-line-number="91"></a>
<a class="sourceLine" id="cb4-92" data-line-number="92"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-93" data-line-number="93"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-94" data-line-number="94"></a>
<a class="sourceLine" id="cb4-95" data-line-number="95"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-96" data-line-number="96"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-97" data-line-number="97"></a>
<a class="sourceLine" id="cb4-98" data-line-number="98"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-99" data-line-number="99"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-100" data-line-number="100"></a>
<a class="sourceLine" id="cb4-101" data-line-number="101"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-102" data-line-number="102"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-103" data-line-number="103"></a>
<a class="sourceLine" id="cb4-104" data-line-number="104"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-105" data-line-number="105"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-106" data-line-number="106"></a>
<a class="sourceLine" id="cb4-107" data-line-number="107"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-108" data-line-number="108"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-109" data-line-number="109"></a>
<a class="sourceLine" id="cb4-110" data-line-number="110"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-111" data-line-number="111"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-112" data-line-number="112"></a>
<a class="sourceLine" id="cb4-113" data-line-number="113"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-114" data-line-number="114"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-115" data-line-number="115"></a>
<a class="sourceLine" id="cb4-116" data-line-number="116"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-117" data-line-number="117"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-118" data-line-number="118"></a>
<a class="sourceLine" id="cb4-119" data-line-number="119"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-120" data-line-number="120"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-121" data-line-number="121"></a>
<a class="sourceLine" id="cb4-122" data-line-number="122"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-123" data-line-number="123"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-124" data-line-number="124"></a>
<a class="sourceLine" id="cb4-125" data-line-number="125"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-126" data-line-number="126"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-127" data-line-number="127"></a>
<a class="sourceLine" id="cb4-128" data-line-number="128"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-129" data-line-number="129"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-130" data-line-number="130"></a>
<a class="sourceLine" id="cb4-131" data-line-number="131"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-132" data-line-number="132"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-133" data-line-number="133"></a>
<a class="sourceLine" id="cb4-134" data-line-number="134"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-135" data-line-number="135"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-136" data-line-number="136"></a>
<a class="sourceLine" id="cb4-137" data-line-number="137"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-138" data-line-number="138"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-139" data-line-number="139"></a>
<a class="sourceLine" id="cb4-140" data-line-number="140"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-141" data-line-number="141"><span class="co">#&gt; generated</span></a>
<a class="sourceLine" id="cb4-142" data-line-number="142"></a>
<a class="sourceLine" id="cb4-143" data-line-number="143"><span class="co">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, i, value = &quot;1&quot;): invalid factor level, NA</span></a>
<a class="sourceLine" id="cb4-144" data-line-number="144"><span class="co">#&gt; generated</span></a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAYAAAAUg66AAAAEDmlDQ1BrQ0dDb2xvclNwYWNlR2VuZXJpY1JHQgAAOI2NVV1oHFUUPpu5syskzoPUpqaSDv41lLRsUtGE2uj+ZbNt3CyTbLRBkMns3Z1pJjPj/KRpKT4UQRDBqOCT4P9bwSchaqvtiy2itFCiBIMo+ND6R6HSFwnruTOzu5O4a73L3PnmnO9+595z7t4LkLgsW5beJQIsGq4t5dPis8fmxMQ6dMF90A190C0rjpUqlSYBG+PCv9rt7yDG3tf2t/f/Z+uuUEcBiN2F2Kw4yiLiZQD+FcWyXYAEQfvICddi+AnEO2ycIOISw7UAVxieD/Cyz5mRMohfRSwoqoz+xNuIB+cj9loEB3Pw2448NaitKSLLRck2q5pOI9O9g/t/tkXda8Tbg0+PszB9FN8DuPaXKnKW4YcQn1Xk3HSIry5ps8UQ/2W5aQnxIwBdu7yFcgrxPsRjVXu8HOh0qao30cArp9SZZxDfg3h1wTzKxu5E/LUxX5wKdX5SnAzmDx4A4OIqLbB69yMesE1pKojLjVdoNsfyiPi45hZmAn3uLWdpOtfQOaVmikEs7ovj8hFWpz7EV6mel0L9Xy23FMYlPYZenAx0yDB1/PX6dledmQjikjkXCxqMJS9WtfFCyH9XtSekEF+2dH+P4tzITduTygGfv58a5VCTH5PtXD7EFZiNyUDBhHnsFTBgE0SQIA9pfFtgo6cKGuhooeilaKH41eDs38Ip+f4At1Rq/sjr6NEwQqb/I/DQqsLvaFUjvAx+eWirddAJZnAj1DFJL0mSg/gcIpPkMBkhoyCSJ8lTZIxk0TpKDjXHliJzZPO50dR5ASNSnzeLvIvod0HG/mdkmOC0z8VKnzcQ2M/Yz2vKldduXjp9bleLu0ZWn7vWc+l0JGcaai10yNrUnXLP/8Jf59ewX+c3Wgz+B34Df+vbVrc16zTMVgp9um9bxEfzPU5kPqUtVWxhs6OiWTVW+gIfywB9uXi7CGcGW/zk98k/kmvJ95IfJn/j3uQ+4c5zn3Kfcd+AyF3gLnJfcl9xH3OfR2rUee80a+6vo7EK5mmXUdyfQlrYLTwoZIU9wsPCZEtP6BWGhAlhL3p2N6sTjRdduwbHsG9kq32sgBepc+xurLPW4T9URpYGJ3ym4+8zA05u44QjST8ZIoVtu3qE7fWmdn5LPdqvgcZz8Ww8BWJ8X3w0PhQ/wnCDGd+LvlHs8dRy6bLLDuKMaZ20tZrqisPJ5ONiCq8yKhYM5cCgKOu66Lsc0aYOtZdo5QCwezI4wm9J/v0X23mlZXOfBjj8Jzv3WrY5D+CsA9D7aMs2gGfjve8ArD6mePZSeCfEYt8CONWDw8FXTxrPqx/r9Vt4biXeANh8vV7/+/16ffMD1N8AuKD/A/8leAvFY9bLAAAAOGVYSWZNTQAqAAAACAABh2kABAAAAAEAAAAaAAAAAAACoAIABAAAAAEAAAEgoAMABAAAAAEAAAEgAAAAAKtAJY0AABvlSURBVHgB7Z15rBRFu4cLAVlEUNaDC4sLBnDBf1D0IiTwETUxUUSDEhfUqBgVbzR6o8YtKl+iUfRKXAKiEo16XRI1ckFiQHFBCcZAFEVAZJFdRTYB8Z5fees45zAzZ/aq7no6GXpOT/fUW89b81BdvbX4q34yTBCAAAQ8EDjIQ5kUCQEIQMASQEA0BAhAwBsBBOQNPQVDAAIIiDYAAQh4I4CAvKGnYAhAAAHRBiAAAW8EEJA39BQMAQggINoABCDgjQAC8oaegiEAAQREG4AABLwRQEDe0FMwBCCAgGgDEICANwIIyBt6CoYABBAQbQACEPBGAAF5Q0/BEIAAAqINQAAC3gggIG/oKRgCEEBAtAEIQMAbAQTkDT0FQwACCIg2AAEIeCOAgLyhp2AIQAAB0QYgAAFvBBCQN/QUDAEIICDaAAQg4I0AAvKGnoIhAAEERBuAAAS8EUBA3tBTMAQggIBoAxCAgDcCCMgbegqGAAQQEG0AAhDwRgABeUNPwRCAAAKiDUAAAt4IICBv6CkYAhBAQLQBCEDAGwEE5A09BUMAAgiINgABCHgjgIC8oadgCEAAAdEGIAABbwQQkDf0FAwBCCAg2gAEIOCNAALyhp6CIQABBEQbgAAEvBFAQN7QUzAEIICAaAMQgIA3AgjIG3oKhgAEEBBtAAIQ8EYAAXlDT8EQgAACog1AAALeCCAgb+gpGAIQQEC0AQhAwBsBBOQNPQVDAAIIiDYAAQh4I4CAvKGnYAhAAAHRBiAAAW8EEJA39BQMAQggINoABCDgjQAC8oaegiEAAQREG4AABLwRQEDe0FMwBCCAgGgDEICANwIIyBt6CoYABBAQbQACEPBGAAF5Q0/BEIAAAqINQAAC3gggIG/oKRgCEEBAtIHEE5g0aZJp0aKFueOOOxJfl9gq0OKv+im2SlPfdBHo37+/adeunVm3bp1Zs2aNadWqVboqmOLa0ANKcXJjqNqXX35pli5daqZMmWI2bdpk3n333RiqnZo6IqDUpDLOirz00kumX79+ZsiQIeass84yU6dOjRNEQmuNgBKaOMI2Zu/evebVV181Y8eOtTguueQSM2vWLLsbBp9kEEBAycgTUWYhMHPmTLN582Yj8WgaM2aMOeigg8z06dOzrM2iEAkwCB1iVoipIAISzvLly81XX33VsP55551nlixZYlasWGGPjDV8wJsgCSCgINNCUM0R+OWXX0zPnj3N/v37Tfv27RtW3717t/njjz/M7Nmzzb/+9a+G5bwJkwDHK8PMC1E1Q+C1116zonniiSdMhw4dGq09ceJEOxiNgBphCfIPekBBpoWgmiNwxhlnmD///NMsWLDggFXHjx9vXnnlFbN27VrTtWvXAz5nQTgEGIQOJxdEUiCBH374wXz22WcNg89NN7viiivMnj17zIwZM5p+xN+BEUBAgSUktnC+++47e/Rq0KBBRmc0Dx8+3Dz99NN5MUgsOtp18cUXZ11v2LBhpnfv3pwTlJVOWAvZBQsrH9FEM2HCBPPee++ZQw45xF5G0bJlSysV7VZpIHnnzp3m4IMPNp9++qnp0qVLNFxiqygCii3jnuu7YcMGo96OpNKxY0croDZt2pjWrVvbyHRUS0exJKFt27YZHe3SiYa64JQpfQQQUPpyGmyNvv/+ezNixAhTV1dnDjvsMCsgHULXhaTqAemKdvWANH6jHtCOHTvMr7/+aq/x6tWrl/nggw+CrRuBlUYAAZXGja2KJCCxSCJHHnmkPTIlAXXq1Mmew9O2bdtGPSC3C+YEtHXrVrNx40a77Zw5c4osmdVDJsB5QCFnJ0Wx6YLR7t27m86dO9uXE5DO4XECcj0gCWjXrl1WSq5nJBQ6rD5y5EiDhNLTMBBQenIZbE2eeuope48eJx31fNx7jQNpN0xjQBLQvn377BjQ77//bgeldbQrc0JCmTSS/x4BJT+HQddAF4ZOnjy5YdxH8jn00EPt+I8kpPd6qRckAWn8R7teuqmY/s42IaFsVJK5DAElM2+JiPr55583Dz/8sJWPzkjW7peTj3a99JKQ3NEw9Xa0+6XekN7nu1knEkpEE2g2SATULCJWKIVAU/nosLt6PJKQhKOX6/3ovUSk8R4d/VLPR/LJJyDFhIRKyUxY2yCgsPKRimimTZtmz9vR4Xb1fDLl03T8R70giUgnJOp8IPV8dC5Qc/JxoJCQI5HMOQJKZt6CjVo9H5002Jx83K6XG4zWbpekIyEVKh8HAQk5EsmbI6Dk5SzYiPPtdmX2fLLJZ/v27fbSC/WA1CMqdkJCxRILY30EFEYeEh9FOfLRJRc6/K5rv/TejQ8VCwUJFUvM//oIyH8OEh9BufKRdNxdDXX+jyYklPhmUVAFEFBBmFgpF4FKyEfXezkB6QxoNwaEhHJRT89yBJSeXNa8JpWSj6TjJsnnt99+c3/SE2ogkc43CCidea16rSolH+1+NX2UstsNc5WgJ+RIpG+OgNKX06rXqJLy0e5X0/s264hY0wkJNSWSjr8RUDryWLNaVFo+uu6rqYB0REw9o6YTEmpKJPl/I6Dk57BmNai0fCQZ3Seo6aRxoKa7YW4dJORIpGOOgNKRx6rXohry0e5XrpMO9VmuCQnlIpO85QgoeTmrecSSz0MPPWSfRJrv2q5sZzirl6OXhNJ0nk9AmUfGslUYCWWjkrxlCCh5OatpxNWSj242n08y2jXLPByfrdJIKBuVZC1DQMnKV02jraZ81PtxT8LIVal8u2FuGyTkSCRzjoCSmbeqR11t+ehG8z169Mhbj+Z6QG5jJORIJG+OgJKXs6pHXAv5SC7NCUjPB9OuWiETEiqEUnjrIKDwcuI1olrIZ/PmzQXVUYfjCxWQvhAJFYQ1qJUQUFDp8BtMreSzadMm061bt4Iqu2XLloLWcyshIUciGXMElIw8VT3KWsrn55/XFywgjRUVOyGhYon5Wx8B+WMfTMm1lM+mTVvN8SeNqK/7xoLqv2/fn+bnn38uaN3MlZBQJo1w3yOgcHNTk8hqLZ/r7nzDzH77icLrVv9osP845yYzf+Z/F77N/6+JhIpGVvMNEFDNkYdToA/5lFL7ficOtZshoVLohb0NAgo7P1WLLinycQCQkCORrjkCSlc+C6pN0uTjKoWEHIn0zBFQenJZUE2SKh9XOSTkSKRjjoA85/GBBx4w9957b6Mojj76aDNw4ED7gL9BgwY1+qycP5IuH1d3JORIJH+OgALJ4UsvvWTvjbxnzx6zceNGM2PGDDN06FCzaNEic/zxx5cdZVrk40AgIUci2XMEFEj+xo4d2+jq8PHjx9trpd5++21z++23lxVl2uTjYCAhRyK5cwQUaO50p0A9KVSPKi5nSqt8HBMk5Egkc46AAsnb3r17bSS6EZd2wR555BH7sL7Ro0eXHGHa5ePAICFHInlzBBRIzg455JADInnnnXfMMcccc8DyQhbEIh/HAgk5EsmaI6BA8vXYY4+Zli1b2scS69qnuXPnmnHjxpnp06ebCy+8sKgoY5OPg4OEHInkzBFQILm68cYbGw1Ca1dsxIgR5u677y5KQLHKx6URCTkSyZgjoEDzpN7QqFGjzF133WXHhLp3795spLHLxwFCQo5E+HMEFHCOFi5caO/y1/TJodlCRj6NqSChxjxC/QsBBZKZV1991Y4BKZzdu3ebOXPmGHcOUHOH4pFP9iQioexcQlqKgALJxuWXX94QyWGHHWZ69eplD8XfcsstDcuzvUE+2aj8swwJ/cMixHcIyHNW7rnnHqNXKRPyKYwaEiqMk4+1EJAP6hUoU4ftp0yZUvHHJespFHogoO7FrKdX6Abyuo2q7mSY5AkJhZk9BBRmXvJGpd2y999/3xxxxBFGA9SdO3c22m3TXM9n13vNi31We1rl42D6ktCYMWPMG28kW+COYaXnCKjSRKv8ffPmzTPvvfeeOfLII02XLl0apIN8CgOfKSE9d6yYqZR7TKuMr7/+2jzzzDPm+uuvL6a4KNZFQAlLs86O7t27t5WPej/q7eilHwc9n8KSmSmhFi3q73pfxFSMhCQfnVCq6/wefPBBBJSFMwLKAiXURRdffLEVT6Z0Dj/88Ea7W+XsdukhgDt37rQXwfbu3d7878v5j8CVw6lFhw4Fbd6j/gTMasWhXVhN27ZtKygWt1IhEpJ89u/fb3R/J51WoTxde+215rnnnnNfw7yeAAJKUDOYP3++OfbYY02H+h+vXpmy0Y/CvVxPqHXr1vbHpR+YBpabzvV8dj1/vU2bNnYwu2fPnjWloduN5Ju0m6lXraddu3aZ5npG+SSU2fORfCR15UvjdkyNCSCgxjyC/ktXzLdr186+2rdvb+dq2Lp3kNsN0w9DYsomHwlo3759pm3btqaurs6+fFc420mWrVq1sqL1HZsrX8y2b9/u/myY55KQ1lfPR+KR3MVbL+WEqTEBBNSYR9B/qcegRqy5fqSuYUtGTkKaO/noR6Mfgz7XS9IJccrsbUiwJ5xwQohhNsSkHs6OHTvs35kS0nKN9zjZKA966bo+5Ut50zqZ9W340kjfIKCEJF7/m6q3oMarlxq1+1tz/a0fr+buR6AfQpIm/UjduExS4tY4j/hL8MqR+LuXy5U+d7nSqQ46Ysn0NwEElJCWoAauxu5e6tnoCIv+dkda3G6CRKQfg8Z49D+1hKT/eUOd9EPt0aOHHSf56aef7O5LqLFmxuXGzpQLjRtpt0vvXW7E3OVLOdIL+WQSZBC6MY3A/9KAphq5XpKK/tZLknEDumrwmiQsN0lE7iVJadtQJvUWdFqBBKRJsa1YsSLrmEsoMWu8rU+fPnbgXpJZv369FY2kr1xIRk1zpXqFxD0UlvSAQslEAXFIHmrcauju9fvvv9suvzZ3PSL3VZkScss0dzLS7oAGpiU0J67M9ar9XvFlG+/Rj3rt2rX2hx1Kz01jOUcddZS9Ra7ko4uFFduqVassT7ESRwlIL+XHicj9R+GDcbVzWO73I6ByCdZw+/vuu89e/6WBZv143QCnQtCPIVsDzyWhzLCdiHQekK7/0g+m2j98HfLXwxfzTboebenSpVas+dar5mfq7fTv39/07dvXykfzTPlIQNrl0qS52Enqeuk/B8lI/3Ho79tuu62aoSbyuxFQgtI2YcIEc//99zeSj8ZPJB69ckmjEAllYtAFqGvXrjPX/tcbpmX9wHClp9lvP1H/lRsL+trt9T/gK/7zlYLWreRKn334stm2fqGVz3HHHZdVPitXrjTr1q2zR7hUthOQej/qZUo6rrep9zfffHMlQ0zFd1W+daUCS7iV0P+42m1R70dHVlzPJ1vvJ7MWxUpI2z737zFVk1BmbKG9d/IZMGCAyScfjVVJLMqFJu0CqwekXS/1ftxdBfSYpZkzZ4ZWzSDiQUBBpKHwIHTk5fXXXzcXXXSRbfBNx31yfZN6SkgoF51/lhcjn+XLl9sNNZCuSf8J6Mxy9YC02yUBST66e8HJJ59s1+GfxgQQUGMeifhr8ODB5pNPPjFDhgzJOu6TrxJIKDedYuSzbNkys3r16oaTQvWt+s9AA9HqAalnpDG1F1980T7dJHepcX+CgBKafx2R+fzzz81pp51WdA2Q0IHIipXPN998Y3s4OtnT9YDcLph6QCeeeKK9DceBJbEkkwACyqSRsPe6UHPBggVIqMy8lSIfDSgPGzbMTJo0ySxZssQOQGtsTrtbJ510UpkRxbM5Akp4rpFQeQksVT6XXnqpLfipp54qOoAnn3zSTJw4sWE7HUzQGdI6IfOmm26yT8TVZSkxTHHUMuWZREKlJbhc+ZRW6j9b6S6JuphVh+/XrFljdLuVK6+80nzxxRf2fK9/1kzvOwSUktwioeIS6Vs+inb06NGmW7duDYHrlIpbb73VTJ482VxwwQVm5MiRDZ+l9Q0CSlFmkVBhyQxBPtki1akSjz76qHnttdfMs88+i4CyQWJZ2AT8SOh/6s+YTsbNtkKVj2tVGg8aPny4Wbx4sVuU6jk9oBSmVxLSIfrTTz+96NqVdoj+ovozpsOXUOjyccnqXn8fbJ1npF0y9YrSPCGglGbXnSeEhP5OcFLko2h1FrW7gVlKm2dDtRBQA4r0vUFCf+c0SfJRxD/++KM9JJ++FnlgjRDQgUxStSR2CSVNPrqIddGiRWbUqFGpaoe5KoOAcpFJ0fJYJZQ0+ajJPfzww0b3QbrhhhtS1AJzVwUB5WaTqk9ik1AS5PPWW2/Zp5noGjLdAfKjjz6yt+246qqrzNChQ1PV/nJVBgHlIpPC5eVKKNcNz3Kheu7ffo6OJUE+YuaeFa8jXXrMtu49pPN/rrnmmlxIU7ccAaUupfkrVI6E9GDEYqdaSygJ8tGFrNwd8e+WhICK/UWlYP20SigJ8klB86loFRBQRXEm58vSJiHkk5y2lxkpAsqkEdl7XxKqNGbkU2mitfs+BFQ71kGW5ENCfQcMM6ZCVxggnyCbVcFBIaCCUaV3xVpLaOU3c+0tS8slWop8dMMvdzOxcstn+/IJIKDyGabiG2otoXKhlSqfcePGlVs021eQAAKqIMykf1UtJeSeJloKM+RTCrUwt0FAYebFW1S1kpAeB13KhHxKoRbuNggo3Nx4i6xWEiq2gsinWGLhr4+Aws+RlwhDkxDy8dIMql4oAqo64uQWUG0J7dixoyA4yKcgTIlcCQElMm21C7qaEirodqP1tyXdtn6hGTBggL1Y85hjjjF9+/Y1vXr1srcsXbVqlVm5cqVZsWKFvY2pnljqnq1VO0qUVCoBBFQquYi2q6aEmsNYV1eHfJqDlODPEVCCk1fL0Kslob179+atBj2fvHgS/yECSnwKa1eBakhItyDNNXXq1Mkce+yxht2uXISSvxwBJT+HNa1BNSSUqwLIJxeZ9CxHQOnJZc1qUgsJtWvXzg42M+Bcs7R6KQgBecGe/EIrKaFsh+MlHuST/HbSXA0QUHOE+DwngUwJFXRIPeOb8t3etU2bNvYwO4faM4Cl9C0CSmlia1WtTAkVe9P6XBKSeJBPrTLotxwE5Jd/KkrPlFCpPaE9e/ZYFq1btzZHHHFE1pMMly5das4++2zDLTVS0WxsJRBQenLptSaZEio2EPWE9Cx0TU3lo8cU65lZunpe5wzNnj3b3HfffXZd/kk+AQSU/BwGU4NMCRW7O6ajXnpAnySzevVqs379erN9+3a7THJSz6hVq1Z2eTAVJpCyCSCgshHyBZkEMiWUuby59/v377eCkXTczcq0Oyf5aO5e7rPmvo/Pk0EAASUjT4mKshQJqfejHs7OnTvNH3/8YSWkZRKO5KT3mrdv3z5RLAg2PwEElJ8Pn5ZIoBgJaXdNg9Dq7Ug+6gVJRE5GWqbPd+/ebYYNq3+iBlNqCCCg1KQyvIpkSijf0TH1cnTujwSkMSCJR9eI6QRFvXbt2mWX6f2TTz4ZXkWJqGQCCKhkdGxYCIFMCWUbmJZ8dBTs4IMPtuM82tWScCQgHfnatm1bw8uJqpByWScZBBBQMvKU6CgzJeQqIhlJNtq1Uo9HR7k0aZxHu1raDZN8JKGtW7eazZs3m7lz59p1+Cc9BBBQenIZdE0yJZQpH8lGu18agNZumpOSdrfUC9qyZYvZuHGjue6660zv3r2DriPBFU+gRX1j+Kv4zdgCAqUR+PXXX83AgQNNt27djO7306FDB9O2bVvbA3IC0qCzekXqAannc/XVV5s777yztALZKmgCCCjo9KQ3uHPOOcd8++23pmPHjvbQesuWLe0gtMZ5JCA3+Dxr1izTv3//9IKIvGYIKPIG4Lv6jz/+uHnmmWdsj0edcY0FDRo0yEydOtV06dLFd3iUX2UCCKjKgGP6ej2homvXrvaoVkz1pq6lE/j7CsDSt2fLyAnMmzfPjB492o7p9OnTx47pnHnmmWbBggWRk6H6hRBAQIVQYp2sBObPn2/OPfdcu/s0adIks3jxYvPss8/a83gkJQ04M0EgHwF2wfLR4bOcBHSbjFNOOcWceuqp5sMPP7QDyG5l7YrpcTpjx44106ZNc4uZQ+AAApwHdAASFhRCQNLRYfIXX3yxkXy0rc7Xefnll+1JhYV8F+vESwABxZv7smq+cOFC07Nnz5wnB55//vllfT8bx0GAMaA48lzxWkpA/fr1q/j38oVxEUBAceW7YrXVHQx1tjITBMohgIDKoRfxthqA/u6773IS0HVcus6LCQL5CCCgfHT4LCcBCUiD0N9//33WdSZOnGg6d+7MPZyz0mGhI8BheEeCeVEENmzYYC+Z0MmHH330UcPtNPQly5Yts9dvDRkyxHz88cdFfS8rx0UAAcWV74rWVuIZMWKEGTlypLnsssvsuT/vvPOOeeGFF+wtND755BN7rlBFC+XLUkUAAaUqnbWvzJtvvmlmzJhhe0G6eZgmXYrx2GOPmcGDB9c+IEpMFAEElKh0hRus7mS4fPlyU1dXZw499NBwAyWyoAggoKDSQTAQiIsAR8Hiyje1hUBQBBBQUOkgGAjERQABxZVvaguBoAggoKDSQTAQiIsAAoor39QWAkERQEBBpYNgIBAXAQQUV76pLQSCIoCAgkoHwUAgLgIIKK58U1sIBEUAAQWVDoKBQFwEEFBc+aa2EAiKAAIKKh0EA4G4CCCguPJNbSEQFAEEFFQ6CAYCcRFAQHHlm9pCICgCCCiodBAMBOIigIDiyje1hUBQBBBQUOkgGAjERQABxZVvaguBoAggoKDSQTAQiIsAAoor39QWAkERQEBBpYNgIBAXAQQUV76pLQSCIoCAgkoHwUAgLgIIKK58U1sIBEUAAQWVDoKBQFwEEFBc+aa2EAiKAAIKKh0EA4G4CCCguPJNbSEQFAEEFFQ6CAYCcRFAQHHlm9pCICgCCCiodBAMBOIigIDiyje1hUBQBBBQUOkgGAjERQABxZVvaguBoAggoKDSQTAQiIsAAoor39QWAkERQEBBpYNgIBAXAQQUV76pLQSCIoCAgkoHwUAgLgIIKK58U1sIBEUAAQWVDoKBQFwEEFBc+aa2EAiKAAIKKh0EA4G4CCCguPJNbSEQFAEEFFQ6CAYCcRFAQHHlm9pCICgCCCiodBAMBOIigIDiyje1hUBQBBBQUOkgGAjERQABxZVvaguBoAggoKDSQTAQiIsAAoor39QWAkERQEBBpYNgIBAXAQQUV76pLQSCIoCAgkoHwUAgLgIIKK58U1sIBEUAAQWVDoKBQFwEEFBc+aa2EAiKAAIKKh0EA4G4CCCguPJNbSEQFAEEFFQ6CAYCcRFAQHHlm9pCICgCCCiodBAMBOIigIDiyje1hUBQBBBQUOkgGAjERQABxZVvaguBoAggoKDSQTAQiIsAAoor39QWAkERQEBBpYNgIBAXAQQUV76pLQSCIoCAgkoHwUAgLgIIKK58U1sIBEUAAQWVDoKBQFwEEFBc+aa2EAiKAAIKKh0EA4G4CCCguPJNbSEQFAEEFFQ6CAYCcRFAQHHlm9pCICgCCCiodBAMBOIigIDiyje1hUBQBBBQUOkgGAjEReD/AJaOa0dgEVAWAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="network-characteristics" class="section level2">
<h2><span class="header-section-number">3.2</span> Network characteristics</h2>
<p>In the following table, we summarize the number of studies from each design and each data format:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">ns.tab</span>(prt.data,std.data))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">IPD</th>
<th align="right">AD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">RCT</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">NRS</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="the-r-implementation" class="section level1">
<h1><span class="header-section-number">4</span> The R implementation</h1>
<p>There are two steps to run the NMA/NMR model. The first step is to create JAGS model using <code>crosnma.model()</code> which involves JAGS code and the reformatted data. In the second step, the output of that function will be used in <code>crosnma.run()</code> to run the analysis through JAGS <span class="citation">(Plummer 2003)</span>.</p>
<div id="naïve-synthesis" class="section level2">
<h2><span class="header-section-number">4.1</span> Naïve synthesis</h2>
<p>This is the simplest method where the evidence from the two designs are combined naively without acknowledging the differences between them, see Section 2.2.1 in <span class="citation">(Hamza T 2021)</span>.</p>
<p><strong>Set up JAGS model</strong></p>
<p>We start by indicating the names of the datasets on participant- (<code>prt.data</code>) and study-level (<code>std.data</code>). Then, the name of the variables on each dataset need to be given respectively in <code>prt.data</code> and <code>std.data</code>. Next, the <code>reference</code> treatment need to be assigned ( drug A). By choosing <code>trt.effect=random</code>, we assign a normal distribution to each relative treatment effect across studies, see the table in Section 2.1. Finally, the different designs; RCT and NRS are combined naively; <code>method.bias = 'naive'</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># jags model: code+data</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"> mod1 &lt;-<span class="st"> </span><span class="kw">crosnma.model</span>(<span class="dt">prt.data=</span>prt.data,</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">                   <span class="dt">std.data=</span>std.data,</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">                   <span class="dt">trt=</span><span class="kw">c</span>(<span class="st">'trt'</span>,<span class="st">'trt'</span>),</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">                   <span class="dt">study=</span><span class="kw">c</span>(<span class="st">'study'</span>,<span class="st">'study'</span>),</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">                   <span class="dt">outcome=</span><span class="kw">c</span>(<span class="st">'outcome'</span>,<span class="st">'outcome'</span>),</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">                   <span class="dt">n=</span><span class="st">'n'</span>,</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">                   <span class="dt">design=</span><span class="kw">c</span>(<span class="st">'design'</span>,<span class="st">'design'</span>),</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">                   <span class="dt">trt.effect=</span><span class="st">'random'</span>,</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">                   <span class="dt">reference=</span><span class="st">'A'</span>,</a>
<a class="sourceLine" id="cb6-11" data-line-number="11">                   <span class="dt">method.bias =</span> <span class="st">'naive'</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12">                    )</a></code></pre></div>
<p><strong>Run JAGS</strong></p>
<p>Next, we fit the NMA model using <code>crosnma.run()</code>which requires the number of adaptations, iterations, thinning and chains to be set.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># run jags</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">jagsfit1 &lt;-<span class="st"> </span><span class="kw">crosnma.run</span>(<span class="dt">model=</span>mod1,</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">              <span class="dt">n.adapt =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">              <span class="dt">n.iter=</span><span class="dv">50</span>,</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">              <span class="dt">thin=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">              <span class="dt">n.chains=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; </span><span class="al">NOTE</span><span class="co">: Stopping adaptation</span></a></code></pre></div>
<p><strong>Output</strong></p>
<p><em>Table of estimates</em></p>
<p>We summarize the estimated parameters by the following table.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">summary</span>(jagsfit1,<span class="dt">expo=</span>T,))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Mean</th>
<th align="right">SD</th>
<th align="right">2.5%</th>
<th align="right">50%</th>
<th align="right">97.5%</th>
<th align="right">Rhat</th>
<th align="right">n.eff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">d.A</td>
<td align="right">1.000</td>
<td align="right">1.000</td>
<td align="right">1.000</td>
<td align="right">1.000</td>
<td align="right">1.000</td>
<td align="right">NaN</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">d.B</td>
<td align="right">0.827</td>
<td align="right">1.900</td>
<td align="right">0.190</td>
<td align="right">0.854</td>
<td align="right">2.605</td>
<td align="right">1.085</td>
<td align="right">64</td>
</tr>
<tr class="odd">
<td align="left">d.C</td>
<td align="right">1.471</td>
<td align="right">1.809</td>
<td align="right">0.476</td>
<td align="right">1.514</td>
<td align="right">4.383</td>
<td align="right">1.033</td>
<td align="right">124</td>
</tr>
<tr class="even">
<td align="left">d.D</td>
<td align="right">0.451</td>
<td align="right">1.984</td>
<td align="right">0.119</td>
<td align="right">0.427</td>
<td align="right">1.895</td>
<td align="right">0.993</td>
<td align="right">145</td>
</tr>
<tr class="odd">
<td align="left">tau</td>
<td align="right">0.978</td>
<td align="right">0.353</td>
<td align="right">0.459</td>
<td align="right">0.940</td>
<td align="right">1.784</td>
<td align="right">1.040</td>
<td align="right">63</td>
</tr>
</tbody>
</table>
<p><em>Plot of estimates</em></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># to be added</span></a></code></pre></div>
</div>
<div id="using-nrs-as-a-prior-1" class="section level2">
<h2><span class="header-section-number">4.2</span> Using NRS as a prior</h2>
<p>In this part, we run a generic NMR model using <code>sex</code> and <code>age</code> as covariates. To combine both designs, we use NRS evidence as a prior information for the RCT likelihood, see Section 2.2.2 in <span class="citation">(Hamza T 2021)</span>.</p>
<p><strong>Set up JAGS model</strong></p>
<p>In this case, three additional arguments are needed; the first one is to run network meta-regression and the rest are to control combining RCT and NRS.</p>
<ol style="list-style-type: decimal">
<li>We set a list of 2 covariates in prt.data and std.data, respectively, <code>covariate=list(c('age','sex'),c('age','sex'))</code>.</li>
<li>We indicate using NRS as a prior<code>method.bias='prior'</code>.<br />
</li>
<li>This means that a NMA is initially run with only NRS data. This requires the following MCMC settings: the number of adaptations, iterations, burn-ins, thinning and chains.</li>
</ol>
<p>In this method, the prior of the RCT basic parameters is set to a normal distribution that is either a minimally informative prior <code>d~dnorm(0, 1e-4)</code> (for those we don’t have NRS information) or the NRS mean and variance (for those which we observe the NRS evidence). The mean can be shifted by <code>mean.shift</code> to reflect the potential bias from NRS or the variance can be inflated by <code>var.infl</code> to control the influence of NRS on the estimation from RCTs.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># jags model: code+data</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">mod2 &lt;-<span class="st"> </span><span class="kw">crosnma.model</span>(<span class="dt">prt.data=</span>prt.data,</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">                   <span class="dt">std.data=</span>std.data,</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">                   <span class="dt">trt=</span><span class="kw">c</span>(<span class="st">'trt'</span>,<span class="st">'trt'</span>),</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">                   <span class="dt">study=</span><span class="kw">c</span>(<span class="st">'study'</span>,<span class="st">'study'</span>),</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">                   <span class="dt">outcome=</span><span class="kw">c</span>(<span class="st">'outcome'</span>,<span class="st">'outcome'</span>),</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">                   <span class="dt">n=</span><span class="st">'n'</span>,</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">                   <span class="dt">design=</span><span class="kw">c</span>(<span class="st">'design'</span>,<span class="st">'design'</span>),</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">                   <span class="dt">reference=</span><span class="st">'A'</span>,</a>
<a class="sourceLine" id="cb10-10" data-line-number="10">                   <span class="dt">trt.effect=</span><span class="st">'random'</span>,</a>
<a class="sourceLine" id="cb10-11" data-line-number="11">                   <span class="co">#----------  meta-regression ---------- </span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12">                   <span class="dt">covariate =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">'age'</span>,<span class="st">'sex'</span>),<span class="kw">c</span>(<span class="st">'age'</span>,<span class="st">'sex'</span>)),</a>
<a class="sourceLine" id="cb10-13" data-line-number="13">                   <span class="co">#---------- bias adjustment ---------- </span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14">                   <span class="dt">method.bias=</span><span class="st">'prior'</span>,</a>
<a class="sourceLine" id="cb10-15" data-line-number="15">                   <span class="dt">run.nrs=</span><span class="kw">list</span>(<span class="dt">n.adapt =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb10-16" data-line-number="16">                                <span class="dt">n.iter=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb10-17" data-line-number="17">                                <span class="dt">n.burnin =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb10-18" data-line-number="18">                                <span class="dt">thin=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb10-19" data-line-number="19">                                <span class="dt">n.chains=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="co">#&gt; The data is analyzed assuming the studies has the same design</span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="co">#&gt; Compiling model graph</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="co">#&gt;    Resolving undeclared variables</span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="co">#&gt;    Allocating nodes</span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="co">#&gt; Graph information:</span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="co">#&gt;    Observed stochastic nodes: 0</span></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="co">#&gt;    Unobserved stochastic nodes: 258</span></a>
<a class="sourceLine" id="cb10-27" data-line-number="27"><span class="co">#&gt;    Total graph size: 1078</span></a>
<a class="sourceLine" id="cb10-28" data-line-number="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-29" data-line-number="29"><span class="co">#&gt; Initializing model</span></a></code></pre></div>
<p><strong>Run JAGS</strong></p>
<p>The MCMC is run under the same set up as in the naive model.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># run jags</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">jagsfit2 &lt;-<span class="st"> </span><span class="kw">crosnma.run</span>(<span class="dt">model=</span>mod2,</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">              <span class="dt">n.adapt =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">              <span class="dt">n.iter=</span><span class="dv">50</span>,</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">              <span class="dt">thin=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">              <span class="dt">n.chains=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; </span><span class="al">NOTE</span><span class="co">: Stopping adaptation</span></a></code></pre></div>
<p><strong>Output</strong></p>
<p><em>Table of estimates</em></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">summary</span>(jagsfit2))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Mean</th>
<th align="right">SD</th>
<th align="right">2.5%</th>
<th align="right">50%</th>
<th align="right">97.5%</th>
<th align="right">Rhat</th>
<th align="right">n.eff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">bb_1</td>
<td align="right">0.978</td>
<td align="right">1.052</td>
<td align="right">0.892</td>
<td align="right">0.981</td>
<td align="right">1.102</td>
<td align="right">1.265</td>
<td align="right">93</td>
</tr>
<tr class="even">
<td align="left">bb_2</td>
<td align="right">8.930</td>
<td align="right">6.061</td>
<td align="right">0.542</td>
<td align="right">14.103</td>
<td align="right">150.227</td>
<td align="right">3.596</td>
<td align="right">78</td>
</tr>
<tr class="odd">
<td align="left">bw_1</td>
<td align="right">1.008</td>
<td align="right">1.364</td>
<td align="right">0.470</td>
<td align="right">1.012</td>
<td align="right">2.126</td>
<td align="right">1.093</td>
<td align="right">420</td>
</tr>
<tr class="even">
<td align="left">bw_2</td>
<td align="right">0.891</td>
<td align="right">1.643</td>
<td align="right">0.308</td>
<td align="right">0.881</td>
<td align="right">2.196</td>
<td align="right">1.766</td>
<td align="right">64</td>
</tr>
<tr class="odd">
<td align="left">d.A</td>
<td align="right">1.000</td>
<td align="right">1.000</td>
<td align="right">1.000</td>
<td align="right">1.000</td>
<td align="right">1.000</td>
<td align="right">NaN</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">d.B</td>
<td align="right">0.467</td>
<td align="right">2.260</td>
<td align="right">0.112</td>
<td align="right">0.566</td>
<td align="right">1.603</td>
<td align="right">2.367</td>
<td align="right">116</td>
</tr>
<tr class="odd">
<td align="left">d.C</td>
<td align="right">0.640</td>
<td align="right">2.725</td>
<td align="right">0.103</td>
<td align="right">0.870</td>
<td align="right">2.839</td>
<td align="right">3.309</td>
<td align="right">62</td>
</tr>
<tr class="even">
<td align="left">d.D</td>
<td align="right">0.374</td>
<td align="right">3.006</td>
<td align="right">0.061</td>
<td align="right">0.348</td>
<td align="right">4.376</td>
<td align="right">1.894</td>
<td align="right">127</td>
</tr>
<tr class="odd">
<td align="left">tau</td>
<td align="right">0.656</td>
<td align="right">0.438</td>
<td align="right">0.065</td>
<td align="right">0.628</td>
<td align="right">1.684</td>
<td align="right">1.189</td>
<td align="right">23</td>
</tr>
<tr class="even">
<td align="left">tau.bb_1</td>
<td align="right">0.068</td>
<td align="right">0.091</td>
<td align="right">0.003</td>
<td align="right">0.037</td>
<td align="right">0.381</td>
<td align="right">1.621</td>
<td align="right">40</td>
</tr>
<tr class="odd">
<td align="left">tau.bb_2</td>
<td align="right">1.032</td>
<td align="right">0.519</td>
<td align="right">0.202</td>
<td align="right">0.992</td>
<td align="right">1.950</td>
<td align="right">1.081</td>
<td align="right">20</td>
</tr>
<tr class="even">
<td align="left">tau.bw_1</td>
<td align="right">0.303</td>
<td align="right">0.463</td>
<td align="right">0.009</td>
<td align="right">0.083</td>
<td align="right">1.602</td>
<td align="right">1.211</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="left">tau.bw_2</td>
<td align="right">0.398</td>
<td align="right">0.360</td>
<td align="right">0.020</td>
<td align="right">0.334</td>
<td align="right">1.257</td>
<td align="right">1.155</td>
<td align="right">39</td>
</tr>
</tbody>
</table>
<p><em>Plot of estimates</em></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co">#plot(jagsfit1)</span></a></code></pre></div>
</div>
<div id="rob-adjusted-model-1-1" class="section level2">
<h2><span class="header-section-number">4.3</span> RoB-adjusted model 1</h2>
<p>In this part, we run again the NMR model using <code>sex</code> and <code>age</code> as covariates. But now, the overall relative treatment effects are estimated from both NRS and RCT with adjustment to study-specific bias following the method introduced by <span class="citation">(Dias et al. 2010)</span>, see also Section 2.3 above.</p>
<p><strong>Set up JAGS model</strong></p>
<p>We provide the name of the bias variable <code>bias=c('bias','bias')</code> in <code>prt.data</code> and <code>std.data</code>, respectively. The effect of bias is assumed to be additive to the treatment effect so <code>bias.type='add'</code>. The bias effect is set to be equal across studies <code>bias.effect='common'</code>. It is optional to give a list of the different priors to control the estimates of the corresponding parameters. Here, we set a uniform distribution to the common heterogeneity of the treatment effect across studies, <code>tau.trt='dunif(0,3)'</code>. We also set beta distribution (<span class="math inline">\({Beta(a,b)}\)</span>) as priors for the probability of bias on each study. We assumed these four categories: high bias RCT <code>pi.high.rct='dbeta(5,1)'</code>, low bias RCT <code>pi.low.rct='dbeta(1,20)'</code>,high bias NRS <code>pi.high.nrs='dbeta(30,1)'</code> and low bias NRS <code>pi.low.nrs='dbeta(1,2)'</code>. The ratio <span class="math inline">\({a/b}\)</span> controls the skewness of the beta distribution. When the ratio goes further beyond 1, the mean becomes located closer to 1 and the study needs ‘major’ bias adjustment and vice versa.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># jags model: code+data</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">mod3 &lt;-<span class="st"> </span><span class="kw">crosnma.model</span>(<span class="dt">prt.data=</span>prt.data,</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">                   <span class="dt">std.data=</span>std.data,</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">                   <span class="dt">trt=</span><span class="kw">c</span>(<span class="st">'trt'</span>,<span class="st">'trt'</span>),</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">                   <span class="dt">study=</span><span class="kw">c</span>(<span class="st">'study'</span>,<span class="st">'study'</span>),</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">                   <span class="dt">outcome=</span><span class="kw">c</span>(<span class="st">'outcome'</span>,<span class="st">'outcome'</span>),</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">                   <span class="dt">n=</span><span class="st">'n'</span>,</a>
<a class="sourceLine" id="cb14-8" data-line-number="8">                   <span class="dt">design=</span><span class="kw">c</span>(<span class="st">'design'</span>,<span class="st">'design'</span>),</a>
<a class="sourceLine" id="cb14-9" data-line-number="9">                   <span class="dt">reference=</span><span class="st">'A'</span>,</a>
<a class="sourceLine" id="cb14-10" data-line-number="10">                   <span class="dt">trt.effect=</span><span class="st">'random'</span>,</a>
<a class="sourceLine" id="cb14-11" data-line-number="11">                   <span class="co">#----------  meta-regression ---------- </span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12">                   <span class="dt">covariate =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">'age'</span>,<span class="st">'sex'</span>),<span class="kw">c</span>(<span class="st">'age'</span>,<span class="st">'sex'</span>)),</a>
<a class="sourceLine" id="cb14-13" data-line-number="13">                   <span class="co">#---------- bias adjustment ---------- </span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14">                   <span class="dt">method.bias=</span><span class="st">'adjust1'</span>,</a>
<a class="sourceLine" id="cb14-15" data-line-number="15">                   <span class="dt">bias=</span><span class="kw">c</span>(<span class="st">'bias'</span>,<span class="st">'bias'</span>), </a>
<a class="sourceLine" id="cb14-16" data-line-number="16">                   <span class="dt">bias.type=</span><span class="st">'add'</span>,</a>
<a class="sourceLine" id="cb14-17" data-line-number="17">                   <span class="dt">bias.effect=</span><span class="st">'common'</span>,</a>
<a class="sourceLine" id="cb14-18" data-line-number="18">                   <span class="co">#---------- assign a prior ---------- </span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19">                   <span class="dt">prior=</span><span class="kw">list</span>(<span class="dt">tau.trt=</span><span class="st">'dunif(0,3)'</span>,</a>
<a class="sourceLine" id="cb14-20" data-line-number="20">                              <span class="dt">pi.high.rct=</span><span class="st">'dbeta(5,1)'</span>,</a>
<a class="sourceLine" id="cb14-21" data-line-number="21">                              <span class="dt">pi.low.rct=</span><span class="st">'dbeta(1,20)'</span>,</a>
<a class="sourceLine" id="cb14-22" data-line-number="22">                              <span class="dt">pi.high.nrs=</span><span class="st">'dbeta(30,1)'</span>,</a>
<a class="sourceLine" id="cb14-23" data-line-number="23">                              <span class="dt">pi.low.nrs=</span><span class="st">'dbeta(1,2)'</span></a>
<a class="sourceLine" id="cb14-24" data-line-number="24">                                  )</a>
<a class="sourceLine" id="cb14-25" data-line-number="25">                  )</a></code></pre></div>
<p><strong>Run JAGS</strong></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># run jags</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2">jagsfit3 &lt;-<span class="st"> </span><span class="kw">crosnma.run</span>(<span class="dt">model=</span>mod3,</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">              <span class="dt">n.adapt =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">              <span class="dt">n.iter=</span><span class="dv">50</span>,</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">              <span class="dt">thin=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">              <span class="dt">n.chains=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="co">#&gt; </span><span class="al">NOTE</span><span class="co">: Stopping adaptation</span></a></code></pre></div>
<p><strong>Output</strong></p>
<p><em>Table of estimates</em></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">summary</span>(jagsfit3))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Mean</th>
<th align="right">SD</th>
<th align="right">2.5%</th>
<th align="right">50%</th>
<th align="right">97.5%</th>
<th align="right">Rhat</th>
<th align="right">n.eff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">bb_1</td>
<td align="right">1.005</td>
<td align="right">1.088</td>
<td align="right">0.855</td>
<td align="right">1.002</td>
<td align="right">1.168</td>
<td align="right">1.140</td>
<td align="right">157</td>
</tr>
<tr class="even">
<td align="left">bb_2</td>
<td align="right">0.691</td>
<td align="right">2.905</td>
<td align="right">0.098</td>
<td align="right">0.780</td>
<td align="right">5.223</td>
<td align="right">1.632</td>
<td align="right">83</td>
</tr>
<tr class="odd">
<td align="left">bw_1</td>
<td align="right">1.014</td>
<td align="right">1.071</td>
<td align="right">0.931</td>
<td align="right">1.006</td>
<td align="right">1.099</td>
<td align="right">1.213</td>
<td align="right">103</td>
</tr>
<tr class="even">
<td align="left">bw_2</td>
<td align="right">0.928</td>
<td align="right">1.656</td>
<td align="right">0.361</td>
<td align="right">0.914</td>
<td align="right">2.971</td>
<td align="right">1.132</td>
<td align="right">110</td>
</tr>
<tr class="odd">
<td align="left">d.A</td>
<td align="right">1.000</td>
<td align="right">1.000</td>
<td align="right">1.000</td>
<td align="right">1.000</td>
<td align="right">1.000</td>
<td align="right">NaN</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">d.B</td>
<td align="right">0.765</td>
<td align="right">1.783</td>
<td align="right">0.285</td>
<td align="right">0.782</td>
<td align="right">2.041</td>
<td align="right">1.870</td>
<td align="right">42</td>
</tr>
<tr class="odd">
<td align="left">d.C</td>
<td align="right">1.076</td>
<td align="right">1.634</td>
<td align="right">0.420</td>
<td align="right">1.127</td>
<td align="right">2.678</td>
<td align="right">1.038</td>
<td align="right">25</td>
</tr>
<tr class="even">
<td align="left">d.D</td>
<td align="right">0.145</td>
<td align="right">2.487</td>
<td align="right">0.029</td>
<td align="right">0.152</td>
<td align="right">0.801</td>
<td align="right">2.279</td>
<td align="right">42</td>
</tr>
<tr class="odd">
<td align="left">g</td>
<td align="right">1.775</td>
<td align="right">1.498</td>
<td align="right">0.625</td>
<td align="right">1.862</td>
<td align="right">3.532</td>
<td align="right">1.542</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td align="left">tau</td>
<td align="right">0.507</td>
<td align="right">0.318</td>
<td align="right">0.120</td>
<td align="right">0.438</td>
<td align="right">1.292</td>
<td align="right">1.222</td>
<td align="right">28</td>
</tr>
<tr class="odd">
<td align="left">tau.bb_1</td>
<td align="right">0.081</td>
<td align="right">0.101</td>
<td align="right">0.007</td>
<td align="right">0.038</td>
<td align="right">0.386</td>
<td align="right">1.182</td>
<td align="right">34</td>
</tr>
<tr class="even">
<td align="left">tau.bb_2</td>
<td align="right">1.132</td>
<td align="right">0.542</td>
<td align="right">0.239</td>
<td align="right">1.110</td>
<td align="right">1.954</td>
<td align="right">1.541</td>
<td align="right">29</td>
</tr>
<tr class="odd">
<td align="left">tau.bw_1</td>
<td align="right">0.060</td>
<td align="right">0.119</td>
<td align="right">0.011</td>
<td align="right">0.029</td>
<td align="right">0.482</td>
<td align="right">1.301</td>
<td align="right">39</td>
</tr>
<tr class="even">
<td align="left">tau.bw_2</td>
<td align="right">0.538</td>
<td align="right">0.410</td>
<td align="right">0.072</td>
<td align="right">0.442</td>
<td align="right">1.730</td>
<td align="right">1.091</td>
<td align="right">40</td>
</tr>
</tbody>
</table>
<p><em>Plot of estimates</em></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co"># to be added</span></a></code></pre></div>
</div>
<div id="rob-adjusted-model-2-1" class="section level2">
<h2><span class="header-section-number">4.4</span> RoB-adjusted model 2</h2>
<p><strong>Set up JAGS model</strong></p>
<p>The arguments for <code>method.bias='adjust2'</code> are similar to the ones that were used above for <code>method.bias='adjust1'</code>. However, there are two main differences between them. First, in <code>'adjust2'</code>, the relative treatment effects are modeled with a bi-modal normal distribution instead of a univariate normal distribution as in <code>'adjust1'</code> method. Second, we can use a logistic model with a year as a covariate <code>bias.covariate = c('year','year')</code> to estimate the probability of bias in <code>'adjust2'</code>. In <code>'adjust1'</code>, instead we assume a (<span class="math inline">\({Beta(a,b)}\)</span>) to estimate the probability of bias. More details about this method can be found in <span class="citation">(Verde 2020)</span> and in Section 2.4.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co"># jags model: code+data</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2">mod4 &lt;-<span class="st"> </span><span class="kw">crosnma.model</span>(<span class="dt">prt.data=</span>prt.data,</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">                   <span class="dt">std.data=</span>std.data,</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">                   <span class="dt">trt=</span><span class="kw">c</span>(<span class="st">'trt'</span>,<span class="st">'trt'</span>),</a>
<a class="sourceLine" id="cb18-5" data-line-number="5">                   <span class="dt">study=</span><span class="kw">c</span>(<span class="st">'study'</span>,<span class="st">'study'</span>),</a>
<a class="sourceLine" id="cb18-6" data-line-number="6">                   <span class="dt">outcome=</span><span class="kw">c</span>(<span class="st">'outcome'</span>,<span class="st">'outcome'</span>),</a>
<a class="sourceLine" id="cb18-7" data-line-number="7">                   <span class="dt">n=</span><span class="st">'n'</span>,</a>
<a class="sourceLine" id="cb18-8" data-line-number="8">                   <span class="dt">design=</span><span class="kw">c</span>(<span class="st">'design'</span>,<span class="st">'design'</span>),</a>
<a class="sourceLine" id="cb18-9" data-line-number="9">                   <span class="dt">reference=</span><span class="st">'A'</span>,</a>
<a class="sourceLine" id="cb18-10" data-line-number="10">                   <span class="dt">trt.effect=</span><span class="st">'random'</span>,</a>
<a class="sourceLine" id="cb18-11" data-line-number="11">                   <span class="co">#----------  meta-regression ----------</span></a>
<a class="sourceLine" id="cb18-12" data-line-number="12">                   <span class="dt">covariate =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">'age'</span>,<span class="st">'sex'</span>),<span class="kw">c</span>(<span class="st">'age'</span>,<span class="st">'sex'</span>)),</a>
<a class="sourceLine" id="cb18-13" data-line-number="13">                   <span class="co">#---------- bias adjustment ----------</span></a>
<a class="sourceLine" id="cb18-14" data-line-number="14">                   <span class="dt">method.bias=</span><span class="st">'adjust1'</span>,</a>
<a class="sourceLine" id="cb18-15" data-line-number="15">                   <span class="dt">bias=</span><span class="kw">c</span>(<span class="st">'bias'</span>,<span class="st">'bias'</span>),</a>
<a class="sourceLine" id="cb18-16" data-line-number="16">                   <span class="dt">bias.type=</span><span class="st">'add'</span>,</a>
<a class="sourceLine" id="cb18-17" data-line-number="17">                   <span class="dt">bias.effect=</span><span class="st">'common'</span>,</a>
<a class="sourceLine" id="cb18-18" data-line-number="18">                   <span class="dt">bias.covariate =</span> <span class="kw">c</span>(<span class="st">'year'</span>,<span class="st">'year'</span>),<span class="co">#</span></a>
<a class="sourceLine" id="cb18-19" data-line-number="19">                   <span class="co">#---------- assign a prior ----------</span></a>
<a class="sourceLine" id="cb18-20" data-line-number="20">                   <span class="dt">prior=</span><span class="kw">list</span>(<span class="dt">tau.trt=</span><span class="st">'dunif(0,3)'</span>,</a>
<a class="sourceLine" id="cb18-21" data-line-number="21">                              <span class="dt">pi.high.rct=</span><span class="st">'dbeta(5,1)'</span>,</a>
<a class="sourceLine" id="cb18-22" data-line-number="22">                              <span class="dt">pi.low.rct=</span><span class="st">'dbeta(1,20)'</span>,</a>
<a class="sourceLine" id="cb18-23" data-line-number="23">                              <span class="dt">pi.high.nrs=</span><span class="st">'dbeta(30,1)'</span>,</a>
<a class="sourceLine" id="cb18-24" data-line-number="24">                              <span class="dt">pi.low.nrs=</span><span class="st">'dbeta(1,2)'</span></a>
<a class="sourceLine" id="cb18-25" data-line-number="25">                   )</a>
<a class="sourceLine" id="cb18-26" data-line-number="26">)</a></code></pre></div>
<p><strong>Run JAGS </strong></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co"># run jags</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">jagsfit4 &lt;-<span class="st"> </span><span class="kw">crosnma.run</span>(<span class="dt">model=</span>mod4,</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">              <span class="dt">n.adapt =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">              <span class="dt">n.iter=</span><span class="dv">50</span>,</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">              <span class="dt">thin=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb19-6" data-line-number="6">              <span class="dt">n.chains=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="co">#&gt; </span><span class="al">NOTE</span><span class="co">: Stopping adaptation</span></a></code></pre></div>
<p><strong>Output</strong></p>
<p><em>Table of estimates</em></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">summary</span>(jagsfit4))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Mean</th>
<th align="right">SD</th>
<th align="right">2.5%</th>
<th align="right">50%</th>
<th align="right">97.5%</th>
<th align="right">Rhat</th>
<th align="right">n.eff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">bb_1</td>
<td align="right">1.001</td>
<td align="right">1.034</td>
<td align="right">0.933</td>
<td align="right">1.000</td>
<td align="right">1.082</td>
<td align="right">1.063</td>
<td align="right">115</td>
</tr>
<tr class="even">
<td align="left">bb_2</td>
<td align="right">1.085</td>
<td align="right">1.870</td>
<td align="right">0.324</td>
<td align="right">1.073</td>
<td align="right">2.304</td>
<td align="right">2.145</td>
<td align="right">82</td>
</tr>
<tr class="odd">
<td align="left">bw_1</td>
<td align="right">1.006</td>
<td align="right">1.215</td>
<td align="right">0.674</td>
<td align="right">1.004</td>
<td align="right">1.596</td>
<td align="right">1.271</td>
<td align="right">579</td>
</tr>
<tr class="even">
<td align="left">bw_2</td>
<td align="right">0.974</td>
<td align="right">1.840</td>
<td align="right">0.260</td>
<td align="right">0.964</td>
<td align="right">2.954</td>
<td align="right">1.051</td>
<td align="right">244</td>
</tr>
<tr class="odd">
<td align="left">d.A</td>
<td align="right">1.000</td>
<td align="right">1.000</td>
<td align="right">1.000</td>
<td align="right">1.000</td>
<td align="right">1.000</td>
<td align="right">NaN</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">d.B</td>
<td align="right">0.422</td>
<td align="right">2.433</td>
<td align="right">0.095</td>
<td align="right">0.322</td>
<td align="right">2.334</td>
<td align="right">3.881</td>
<td align="right">27</td>
</tr>
<tr class="odd">
<td align="left">d.C</td>
<td align="right">0.810</td>
<td align="right">1.409</td>
<td align="right">0.448</td>
<td align="right">0.781</td>
<td align="right">1.380</td>
<td align="right">1.933</td>
<td align="right">119</td>
</tr>
<tr class="even">
<td align="left">d.D</td>
<td align="right">0.598</td>
<td align="right">1.444</td>
<td align="right">0.292</td>
<td align="right">0.594</td>
<td align="right">1.089</td>
<td align="right">1.147</td>
<td align="right">35</td>
</tr>
<tr class="odd">
<td align="left">g</td>
<td align="right">0.153</td>
<td align="right">844.884</td>
<td align="right">0.000</td>
<td align="right">0.351</td>
<td align="right">545093.763</td>
<td align="right">1.723</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="left">tau</td>
<td align="right">0.318</td>
<td align="right">0.252</td>
<td align="right">0.046</td>
<td align="right">0.268</td>
<td align="right">0.922</td>
<td align="right">1.222</td>
<td align="right">19</td>
</tr>
<tr class="odd">
<td align="left">tau.bb_1</td>
<td align="right">0.056</td>
<td align="right">0.054</td>
<td align="right">0.010</td>
<td align="right">0.039</td>
<td align="right">0.179</td>
<td align="right">1.341</td>
<td align="right">86</td>
</tr>
<tr class="even">
<td align="left">tau.bb_2</td>
<td align="right">0.430</td>
<td align="right">0.505</td>
<td align="right">0.007</td>
<td align="right">0.249</td>
<td align="right">1.894</td>
<td align="right">1.452</td>
<td align="right">40</td>
</tr>
<tr class="odd">
<td align="left">tau.bw_1</td>
<td align="right">0.165</td>
<td align="right">0.370</td>
<td align="right">0.003</td>
<td align="right">0.037</td>
<td align="right">1.528</td>
<td align="right">1.520</td>
<td align="right">29</td>
</tr>
<tr class="even">
<td align="left">tau.bw_2</td>
<td align="right">0.779</td>
<td align="right">0.494</td>
<td align="right">0.128</td>
<td align="right">0.612</td>
<td align="right">1.877</td>
<td align="right">1.125</td>
<td align="right">69</td>
</tr>
</tbody>
</table>
<p><em>Plot of estimates</em></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># to be added</span></a></code></pre></div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-dias_2010">
<p>Dias, Sofia, N. J. Welton, V. C. C. Marinho, G. Salanti, J.P.T Higgins, and A. E. Ades. 2010. “Estimation and Adjustment of Bias in Randomized Evidence by Using Mixed Treatment Comparison Meta-Analysis.” <em>Journal of the Royal Statistical Society</em> 173: 613–29.</p>
</div>
<div id="ref-hamza_2021">
<p>Hamza T, Kuhle J, Pellegrini F. 2021. “Flexible Generic Framework for Evidence Synthesis in Health Technology Assessment.” <em>Unpublished</em>.</p>
</div>
<div id="ref-plummer_jags">
<p>Plummer, Martyn. 2003. “JAGS: A Program for Analysis of Bayesian Graphical Models Using Gibbs Sampling.”</p>
</div>
<div id="ref-verde_2020">
<p>Verde, Pablo Emilio. 2020. “A Bias-Corrected Meta-Analysis Model for Combining, Studies of Different Types and Quality.” <em>Biometrical Journal. Biometrische Zeitschrift</em>, September. <a href="https://doi.org/10.1002/bimj.201900376">https://doi.org/10.1002/bimj.201900376</a>.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
