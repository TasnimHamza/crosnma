<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Tasnim Hamza" />

<meta name="date" content="2021-06-05" />

<title>Cross-design and cross-data format synthesis using Network Meta-Analysis (crosnma)</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Cross-design and cross-data format synthesis using Network Meta-Analysis (crosnma)</h1>
<h4 class="author">Tasnim Hamza</h4>
<h4 class="date">2021-06-05</h4>


<div id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#explore-the-network"><span class="toc-section-number">2</span> Explore the network</a><ul>
<li><a href="#check-network-connectivity"><span class="toc-section-number">2.1</span> Check network connectivity</a><ul>
<li><a href="#network-plot"><span class="toc-section-number">2.1.1</span> Network plot</a></li>
</ul></li>
<li><a href="#network-characteristics"><span class="toc-section-number">2.2</span> Network characteristics</a></li>
</ul></li>
<li><a href="#the-generic-nmanmr-models-to-combine-rct-and-nrs"><span class="toc-section-number">3</span> The generic NMA/NMR models to combine RCT and NRS</a><ul>
<li><a href="#naïve-method"><span class="toc-section-number">3.1</span> Naïve method</a><ul>
<li><a href="#run-jags"><span class="toc-section-number">3.1.1</span> Run JAGS</a></li>
<li><a href="#output"><span class="toc-section-number">3.1.2</span> Output</a></li>
</ul></li>
<li><a href="#using-nrs-as-a-prior"><span class="toc-section-number">3.2</span> Using NRS as a prior</a><ul>
<li><a href="#set-up-jags-model"><span class="toc-section-number">3.2.1</span> Set up JAGS model</a></li>
<li><a href="#run-jags-1"><span class="toc-section-number">3.2.2</span> Run JAGS</a></li>
<li><a href="#output-1"><span class="toc-section-number">3.2.3</span> Output</a></li>
</ul></li>
<li><a href="#adjusting-for-the-study-specific-bias---method-1"><span class="toc-section-number">3.3</span> Adjusting for the study-specific bias - method 1</a><ul>
<li><a href="#set-up-jags-model-1"><span class="toc-section-number">3.3.1</span> Set up JAGS model</a></li>
<li><a href="#run-jags-2"><span class="toc-section-number">3.3.2</span> Run JAGS</a></li>
<li><a href="#output-2"><span class="toc-section-number">3.3.3</span> Output</a></li>
</ul></li>
<li><a href="#adjusting-for-the-study-specific-bias---method-2"><span class="toc-section-number">3.4</span> Adjusting for the study-specific bias - method 2</a><ul>
<li><a href="#set-up-jags-model-2"><span class="toc-section-number">3.4.1</span> Set up JAGS model</a></li>
<li><a href="#run-jags-3"><span class="toc-section-number">3.4.2</span> Run JAGS</a></li>
<li><a href="#output-3"><span class="toc-section-number">3.4.3</span> Output</a></li>
</ul></li>
</ul></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(crosnma)</a></code></pre></div>
<div id="introduction" class="section level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>Network meta-analysis (NMA) is a common tool to compare multiple interventions simultaneously. This requires synthesize the available evidence that might come as different study design or data format. As different study designs, the evidence can be obtained from non-randomized studies (NRS) or randomized controlled trials (RCT). RCT evidence quality is considered the highest and at a lower risk of bias, however, the restricted settings when RCTs are conducted limit the generalizability of their results. Therefore, combining RCT and NRS evidence in NMA may help overcome some of the limitations. Such evidence can be accessible in different data formats as individual participant data (IPD) or aggregate data (AD). We establish a cross-design and cross-data format tool (<code>crosnma</code>) to utilize all available and relevant evidence.</p>
<p>We describe the R package <code>crosnma</code> in a worked example about relapsing remitting multiple sclerosis (RRMS). The primary outcome is the occurrence of relapses in two years (binary, yes/no). In the analysis, the outcome will be expressed as odds ratio (OR). The aim is to compare the efficacy of four treatments. Data is available from 6 different studies in different formats and different designs. The studies are either available as study-level data <code>std.data</code> (2 studies) or as individual participant data <code>prt.data</code> (four studies). Three of the <code>prt.data</code> are RCTs and one comes from an observational study (NRS). The two <code>std.data</code> are RCTs.</p>
<p>The <code>prt.data</code> contains 2950 rows, each refers to a participant in the study. We display the first few rows of the data set:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">head</span>(prt.data)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt;   study outcome trt design age sex bias year</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt; 1     1       0   D    rct  20   1  low 2002</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt; 2     1       0   D    rct  29   0  low 2002</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; 3     1       0   D    rct  35   0  low 2002</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; 4     1       0   D    rct  38   0  low 2002</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; 5     1       0   D    rct  37   0  low 2002</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; 6     1       0   D    rct  32   0  low 2002</span></a></code></pre></div>
<p>For each participant, we have information for the occurrence of the relapses (0:no, 1:yes) <code>outcome</code>, the treatment label <code>trt</code>, the age (in years) <code>age</code> and sex (0: Female, 1: Male) <code>sex</code> of the participant. The other following columns are set on study-level (it is repeated for each participant of the study): the study id <code>study</code>, the design of the study ( needs to be either rct or nrs) <code>design</code>, the risk of bias on each study (set as a low, high or unclear) <code>bias</code> and the year of publication <code>year</code>.</p>
<p>We display the full data on study-level:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">head</span>(std.data)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt;   study outcome   n trt design  age sex    bias year</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; 1     1      19  25   A    rct 34.3 0.2     low 2010</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt; 2     1      11  25   C    rct 34.3 0.3     low 2010</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; 3     2      97 126   A    rct 30.0 0.4 unclear 2015</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt; 4     2      89 125   C    rct 30.0 0.5 unclear 2015</span></a></code></pre></div>
<p>For all studies, we provide the following information on each arm level: the total number of participants <code>n</code> and those wit relapses <code>outcome</code>, the treatment label <code>trt</code>. At study-level, we have the study id <code>study</code>, the design of the study <code>design</code>, the mean age <code>age</code>, the percentage of males <code>sex</code>, the risk of bias on the study <code>bias</code> and the year of publication <code>year</code>. # Methods # The underlying assumptions of parameters We summarize the different assumptions that can be set for the parameters in the model by the following table.</p>
<table>
<colgroup>
<col width="51%"></col>
<col width="30%"></col>
<col width="17%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left">Parameters</th>
<th align="left">Assumptions</th>
<th align="left">R-code in <code>crosnma.model()</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">relative treatment effect (<span class="math inline">\(\delta_{jk}\)</span>)</td>
<td align="left">Random-effect model: <span class="math inline">\(\delta_{jk} \sim N(d_{Ak}-d_{Ab}, \tau_\delta^2)\)</span></td>
<td align="left"><code>trt.effect='random'</code></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Common-effect model: <span class="math inline">\(\delta_{jk}=d_{Ak}-d_{Ab}\)</span></td>
<td align="left"><code>trt.effect='common'</code></td>
</tr>
<tr class="odd">
<td align="left">Covariate effect <span class="math inline">\(\beta_{0, j}\)</span></td>
<td align="left">Independent effect model: <span class="math inline">\(\beta_{0, j} \sim N(0, 10^2)\)</span></td>
<td align="left"><code>reg0.effect='independent'</code></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Random-effect model: <span class="math inline">\(\beta_{0,j} \sim N(B_0, \tau_{\beta_0})\)</span></td>
<td align="left"><code>reg0.effect='random'</code></td>
</tr>
<tr class="odd">
<td align="left">Within-study covariate-treatment interaction (<span class="math inline">\(\beta_{1, jk}^W\)</span>)</td>
<td align="left">Random-effect model: <span class="math inline">\(\beta_{1, jk}^W \sim N(B_{1, Ak}^W-B_{1, Ab}^W, \tau_{\beta_1^W})\)</span></td>
<td align="left"><code>regw.effect='random'</code></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Common-effect model: <span class="math inline">\(\beta_{1,jk}^W = B_{1, Ak}^W-B_{1, Ab}^W\)</span></td>
<td align="left"><code>regw.effect='common'</code></td>
</tr>
<tr class="odd">
<td align="left">Between-study covariate-treatment interaction (<span class="math inline">\(\beta_{1, jk}^B\)</span>)</td>
<td align="left">Random-effect model: <span class="math inline">\(\beta_{1,jk}^B \sim N(B_{1, Ak}^B-B_{1, Ab}^B, \tau_{\beta_1^B})\)</span></td>
<td align="left"><code>regb.effect='random'</code></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Common-effect model: <span class="math inline">\(\beta_{1,jk}^B = B_{1, Ak}^B-B_{1, Ab}^B\)</span></td>
<td align="left"><code>regb.effect='common'</code></td>
</tr>
<tr class="odd">
<td align="left">Bias effect (<span class="math inline">\(\gamma_{j}\)</span>)</td>
<td align="left">Random-effect model: <span class="math inline">\(\gamma_{j} \sim N(\Gamma, \tau_{\gamma})\)</span></td>
<td align="left"><code>bias.effect='random'</code></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Common-effect model: <span class="math inline">\(\gamma_{j} = \Gamma\)</span></td>
<td align="left"><code>bias.effect='common'</code></td>
</tr>
</tbody>
</table>
<p>Here, the participant <span class="math inline">\(i\)</span> in study <span class="math inline">\(j\)</span> has been assigned to treatment <span class="math inline">\(k\)</span>. The index <span class="math inline">\(b\)</span> refers to the study-specific baseline treatment. The term <span class="math inline">\(\tau_*\)</span> refers to the heterogeneity between studies with a subscript (<span class="math inline">\(_*\)</span>) to indicate the corresponding parameter. More details can be found in Section 2 in <span class="citation">(Hamza T 2021)</span>.</p>
</div>
<div id="explore-the-network" class="section level1">
<h1><span class="header-section-number">2</span> Explore the network</h1>
<div id="check-network-connectivity" class="section level2">
<h2><span class="header-section-number">2.1</span> Check network connectivity</h2>
<p>The network should be checked for its connectivity before running the analysis. This is a vital step as the model will run even if the network is not connected. In this case, it provides the wrong estimates which are our pre-specified prior information.</p>
<div id="network-plot" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Network plot</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># to be added later</span></a></code></pre></div>
</div>
</div>
<div id="network-characteristics" class="section level2">
<h2><span class="header-section-number">2.2</span> Network characteristics</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># to be added</span></a></code></pre></div>
</div>
</div>
<div id="the-generic-nmanmr-models-to-combine-rct-and-nrs" class="section level1">
<h1><span class="header-section-number">3</span> The generic NMA/NMR models to combine RCT and NRS</h1>
<p>Two steps to run the NMA/NMR model. The first step is to create JAGS model using <code>crosnma.model()</code> which involves JAGS code and the reformatted data. In the second step, the output of that function will be used in <code>crosnma.run()</code> to run the analysis through JAGS <span class="citation">(Plummer 2003)</span>.</p>
<p>In the rest of the document we illustrate the four different methods that can be used to combine the evidence from RCT and NRS. For each method, we set up the model, run the analysis and present the results.</p>
<div id="naïve-method" class="section level2">
<h2><span class="header-section-number">3.1</span> Naïve method</h2>
<p>This is the simplest method where the evidence from the two designs are combined naively without acknowledging the differences between them, see Section 2.2.1 in <span class="citation">(Hamza T 2021)</span>. ### Set up JAGS model We start by indicating the names of the datasets on participant- (<code>prt.data</code>) and study-level (<code>std.data</code>). Then, the name of the variables on each dataset need to be given respectively in <code>prt.data</code> and <code>std.data</code>. Next, the <code>reference</code> treatment need to be assigned ( drug A). By choosing <code>trt.effect=random</code>, we assign a normal distribution to each relative treatment effect across studies, see the table in Section 1. Finally, the different designs; RCT and NRS are combined naively; <code>method.bias = 'naive'</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># jags model: code+data</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"> mod1 &lt;-<span class="st"> </span><span class="kw">crosnma.model</span>(<span class="dt">prt.data=</span>prt.data,</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">                   <span class="dt">std.data=</span>std.data,</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">                   <span class="dt">trt=</span><span class="kw">c</span>(<span class="st">'trt'</span>,<span class="st">'trt'</span>),</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">                   <span class="dt">study=</span><span class="kw">c</span>(<span class="st">'study'</span>,<span class="st">'study'</span>),</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">                   <span class="dt">outcome=</span><span class="kw">c</span>(<span class="st">'outcome'</span>,<span class="st">'outcome'</span>),</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">                   <span class="dt">n=</span><span class="st">'n'</span>,</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">                   <span class="dt">design=</span><span class="kw">c</span>(<span class="st">'design'</span>,<span class="st">'design'</span>),</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">                   <span class="dt">trt.effect=</span><span class="st">'random'</span>,</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">                   <span class="dt">reference=</span><span class="st">'A'</span>,</a>
<a class="sourceLine" id="cb6-11" data-line-number="11">                   <span class="dt">method.bias =</span> <span class="st">'naive'</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12">                    )</a></code></pre></div>
<div id="run-jags" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Run JAGS</h3>
<p>Next, we fit the NMA model using <code>crosnma.run()</code>which requires the number of adaptations, iterations, thinning and chains to be set.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># run jags</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">jagsfit1 &lt;-<span class="st"> </span><span class="kw">crosnma.run</span>(<span class="dt">model=</span>mod1,</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">              <span class="dt">n.adapt =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">              <span class="dt">n.iter=</span><span class="dv">50</span>,</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">              <span class="dt">thin=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">              <span class="dt">n.chains=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; </span><span class="al">NOTE</span><span class="co">: Stopping adaptation</span></a></code></pre></div>
</div>
<div id="output" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Output</h3>
<div id="table-of-estimates" class="section level4">
<h4><span class="header-section-number">3.1.2.1</span> Table of estimates</h4>
<p>We summarize the estimated parameters by the following table.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">summary</span>(jagsfit1,<span class="dt">expo=</span>T))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Mean</th>
<th align="right">SD</th>
<th align="right">2.5%</th>
<th align="right">50%</th>
<th align="right">97.5%</th>
<th align="right">Rhat</th>
<th align="right">n.eff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">d.A</td>
<td align="right">1.0000000</td>
<td align="right">1.0000000</td>
<td align="right">1.0000000</td>
<td align="right">1.0000000</td>
<td align="right">1.000000</td>
<td align="right">NaN</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">d.B</td>
<td align="right">0.7279476</td>
<td align="right">1.6416260</td>
<td align="right">0.3125442</td>
<td align="right">0.7256774</td>
<td align="right">2.107421</td>
<td align="right">1.127</td>
<td align="right">150</td>
</tr>
<tr class="odd">
<td align="left">d.C</td>
<td align="right">1.2894271</td>
<td align="right">1.6633657</td>
<td align="right">0.5006472</td>
<td align="right">1.1948716</td>
<td align="right">3.256050</td>
<td align="right">1.099</td>
<td align="right">114</td>
</tr>
<tr class="even">
<td align="left">d.D</td>
<td align="right">0.3547490</td>
<td align="right">1.8723703</td>
<td align="right">0.0838159</td>
<td align="right">0.3556758</td>
<td align="right">1.056852</td>
<td align="right">1.014</td>
<td align="right">148</td>
</tr>
<tr class="odd">
<td align="left">tau</td>
<td align="right">0.9234238</td>
<td align="right">0.3144997</td>
<td align="right">0.4834785</td>
<td align="right">0.8625324</td>
<td align="right">1.733238</td>
<td align="right">1.081</td>
<td align="right">65</td>
</tr>
</tbody>
</table>
</div>
<div id="plot-of-estimates" class="section level4">
<h4><span class="header-section-number">3.1.2.2</span> Plot of estimates</h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># to be added</span></a></code></pre></div>
</div>
</div>
</div>
<div id="using-nrs-as-a-prior" class="section level2">
<h2><span class="header-section-number">3.2</span> Using NRS as a prior</h2>
<p>In this part, we run a generic NMR model using <code>sex</code> and <code>age</code> as covariates. To combine both designs, we use NRS evidence as a prior information for the RCT likelihood, see Section 2.2.2 in <span class="citation">(Hamza T 2021)</span>.</p>
<div id="set-up-jags-model" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Set up JAGS model</h3>
<p>In this case, three additional arguments are needed; the first one is to run network meta-regression and the rest are to control combining RCT and NRS.</p>
<ol style="list-style-type: decimal">
<li>We set a list of 2 covariates in prt.data and std.data, respectively, <code>covariate=list(c('age','sex'),c('age','sex'))</code>.</li>
<li>We indicate using NRS as a prior<code>method.bias='prior'</code>.<br />
</li>
<li>This means that a NMA is initially run with only NRS data. This requires the following MCMC settings: the number of adaptations, iterations, burn-ins, thinning and chains.</li>
</ol>
<p>In this method, the prior of the RCT basic parameters is set to a normal distribution that is either a minimally informative prior <code>d~dnorm(0, 1e-4)</code> (for those we don’t have NRS information) or the NRS mean and variance (for those which we observe the NRS evidence). The mean can be shifted by <code>mean.shift</code> to reflect the potential bias from NRS or the variance can be inflated by <code>var.infl</code> to control the influence of NRS on the estimation from RCTs.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># jags model: code+data</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">mod2 &lt;-<span class="st"> </span><span class="kw">crosnma.model</span>(<span class="dt">prt.data=</span>prt.data,</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">                   <span class="dt">std.data=</span>std.data,</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">                   <span class="dt">trt=</span><span class="kw">c</span>(<span class="st">'trt'</span>,<span class="st">'trt'</span>),</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">                   <span class="dt">study=</span><span class="kw">c</span>(<span class="st">'study'</span>,<span class="st">'study'</span>),</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">                   <span class="dt">outcome=</span><span class="kw">c</span>(<span class="st">'outcome'</span>,<span class="st">'outcome'</span>),</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">                   <span class="dt">n=</span><span class="st">'n'</span>,</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">                   <span class="dt">design=</span><span class="kw">c</span>(<span class="st">'design'</span>,<span class="st">'design'</span>),</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">                   <span class="dt">reference=</span><span class="st">'A'</span>,</a>
<a class="sourceLine" id="cb10-10" data-line-number="10">                   <span class="dt">trt.effect=</span><span class="st">'random'</span>,</a>
<a class="sourceLine" id="cb10-11" data-line-number="11">                   <span class="co">#----------  meta-regression ---------- </span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12">                   <span class="dt">covariate =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">'age'</span>,<span class="st">'sex'</span>),<span class="kw">c</span>(<span class="st">'age'</span>,<span class="st">'sex'</span>)),</a>
<a class="sourceLine" id="cb10-13" data-line-number="13">                   <span class="co">#---------- bias adjustment ---------- </span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14">                   <span class="dt">method.bias=</span><span class="st">'prior'</span>,</a>
<a class="sourceLine" id="cb10-15" data-line-number="15">                   <span class="dt">run.nrs=</span><span class="kw">list</span>(<span class="dt">n.adapt =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb10-16" data-line-number="16">                                <span class="dt">n.iter=</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb10-17" data-line-number="17">                                <span class="dt">n.burnin =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb10-18" data-line-number="18">                                <span class="dt">thin=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb10-19" data-line-number="19">                                <span class="dt">n.chains=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="co">#&gt; The data is analyzed assuming the studies has the same design</span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="co">#&gt; Compiling model graph</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="co">#&gt;    Resolving undeclared variables</span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="co">#&gt;    Allocating nodes</span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"><span class="co">#&gt; Graph information:</span></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="co">#&gt;    Observed stochastic nodes: 0</span></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="co">#&gt;    Unobserved stochastic nodes: 258</span></a>
<a class="sourceLine" id="cb10-27" data-line-number="27"><span class="co">#&gt;    Total graph size: 1078</span></a>
<a class="sourceLine" id="cb10-28" data-line-number="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-29" data-line-number="29"><span class="co">#&gt; Initializing model</span></a></code></pre></div>
</div>
<div id="run-jags-1" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Run JAGS</h3>
<p>The MCMC is run under the same set up as in the naive model (Section 4.1.2).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># run jags</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">jagsfit2 &lt;-<span class="st"> </span><span class="kw">crosnma.run</span>(<span class="dt">model=</span>mod2,</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">              <span class="dt">n.adapt =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">              <span class="dt">n.iter=</span><span class="dv">50</span>,</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">              <span class="dt">thin=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb11-6" data-line-number="6">              <span class="dt">n.chains=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; </span><span class="al">NOTE</span><span class="co">: Stopping adaptation</span></a></code></pre></div>
</div>
<div id="output-1" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Output</h3>
<div id="table-of-estimates-1" class="section level4">
<h4><span class="header-section-number">3.2.3.1</span> Table of estimates</h4>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">summary</span>(jagsfit2))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Mean</th>
<th align="right">SD</th>
<th align="right">2.5%</th>
<th align="right">50%</th>
<th align="right">97.5%</th>
<th align="right">Rhat</th>
<th align="right">n.eff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">bb_1</td>
<td align="right">0.9881942</td>
<td align="right">1.4146969</td>
<td align="right">0.4614474</td>
<td align="right">0.9874772</td>
<td align="right">2.166787</td>
<td align="right">1.006</td>
<td align="right">181</td>
</tr>
<tr class="even">
<td align="left">bb_2</td>
<td align="right">2.1425490</td>
<td align="right">4.1812522</td>
<td align="right">0.2093906</td>
<td align="right">1.8635919</td>
<td align="right">32.421325</td>
<td align="right">2.391</td>
<td align="right">65</td>
</tr>
<tr class="odd">
<td align="left">bw_1</td>
<td align="right">1.0191733</td>
<td align="right">1.1420804</td>
<td align="right">0.9217541</td>
<td align="right">1.0090807</td>
<td align="right">1.163760</td>
<td align="right">1.152</td>
<td align="right">219</td>
</tr>
<tr class="even">
<td align="left">bw_2</td>
<td align="right">0.9623252</td>
<td align="right">1.7726165</td>
<td align="right">0.2297209</td>
<td align="right">0.9853601</td>
<td align="right">2.256732</td>
<td align="right">1.063</td>
<td align="right">29</td>
</tr>
<tr class="odd">
<td align="left">d.A</td>
<td align="right">1.0000000</td>
<td align="right">1.0000000</td>
<td align="right">1.0000000</td>
<td align="right">1.0000000</td>
<td align="right">1.000000</td>
<td align="right">NaN</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">d.B</td>
<td align="right">0.7579944</td>
<td align="right">3.6716984</td>
<td align="right">0.0488213</td>
<td align="right">0.8404582</td>
<td align="right">7.494208</td>
<td align="right">1.622</td>
<td align="right">134</td>
</tr>
<tr class="odd">
<td align="left">d.C</td>
<td align="right">0.4037036</td>
<td align="right">2.2283687</td>
<td align="right">0.1101565</td>
<td align="right">0.3665680</td>
<td align="right">2.924591</td>
<td align="right">1.115</td>
<td align="right">161</td>
</tr>
<tr class="even">
<td align="left">d.D</td>
<td align="right">48.8077726</td>
<td align="right">4.0426223</td>
<td align="right">4.6183577</td>
<td align="right">41.7994716</td>
<td align="right">1029.471837</td>
<td align="right">1.496</td>
<td align="right">117</td>
</tr>
<tr class="odd">
<td align="left">tau</td>
<td align="right">1.0386497</td>
<td align="right">0.4967491</td>
<td align="right">0.2974187</td>
<td align="right">0.9170463</td>
<td align="right">1.923511</td>
<td align="right">1.283</td>
<td align="right">14</td>
</tr>
<tr class="even">
<td align="left">tau.bb_1</td>
<td align="right">0.4329069</td>
<td align="right">0.4190157</td>
<td align="right">0.0486462</td>
<td align="right">0.2683952</td>
<td align="right">1.542213</td>
<td align="right">1.067</td>
<td align="right">31</td>
</tr>
<tr class="odd">
<td align="left">tau.bb_2</td>
<td align="right">1.2394522</td>
<td align="right">0.4343015</td>
<td align="right">0.4946175</td>
<td align="right">1.2372039</td>
<td align="right">1.910907</td>
<td align="right">1.006</td>
<td align="right">46</td>
</tr>
<tr class="even">
<td align="left">tau.bw_1</td>
<td align="right">0.1140243</td>
<td align="right">0.2610668</td>
<td align="right">0.0061732</td>
<td align="right">0.0313075</td>
<td align="right">1.080947</td>
<td align="right">1.153</td>
<td align="right">50</td>
</tr>
<tr class="odd">
<td align="left">tau.bw_2</td>
<td align="right">0.5675227</td>
<td align="right">0.4838438</td>
<td align="right">0.0195023</td>
<td align="right">0.3733717</td>
<td align="right">1.815918</td>
<td align="right">1.096</td>
<td align="right">31</td>
</tr>
</tbody>
</table>
</div>
<div id="plot-of-estimates-1" class="section level4">
<h4><span class="header-section-number">3.2.3.2</span> Plot of estimates</h4>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co">#plot(jagsfit1)</span></a></code></pre></div>
</div>
</div>
</div>
<div id="adjusting-for-the-study-specific-bias---method-1" class="section level2">
<h2><span class="header-section-number">3.3</span> Adjusting for the study-specific bias - method 1</h2>
<p>In this part, we run again a generic NMR model using <code>sex</code> and <code>age</code> as covariates. But now, the overall relative treatment effects are estimated from both NRS and RCT with adjustment to study-specific bias following the method introduced by <span class="citation">(Dias et al. 2010)</span>, see also Section 2.2.3 in <span class="citation">(Hamza T 2021)</span>.</p>
<div id="set-up-jags-model-1" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Set up JAGS model</h3>
<p>Additionally, we provide the name of the bias variable <code>bias=c('bias','bias')</code> in <code>prt.data</code> and <code>std.data</code>, respectively. The effect of bias is assumed to be additive to the treatment effect so <code>bias.type='add'</code>. The bias effect is set to be equal across studies <code>bias.effect='common'</code>. It is optional to give a list of the different priors to control the estimates of the corresponding parameters. Here, we set a uniform distribution to the common heterogeneity of the treatment effect across studies, <code>tau.trt='dunif(0,3)'</code>. We also set beta distribution (<span class="math inline">\({Beta(a,b)}\)</span>) as priors for the probability of bias on each study. We assumed these four categories: high bias RCT <code>pi.high.rct='dbeta(5,1)'</code>, low bias RCT <code>pi.low.rct='dbeta(1,20)'</code>,high bias NRS <code>pi.high.nrs='dbeta(30,1)'</code> and low bias NRS <code>pi.low.nrs='dbeta(1,2)'</code>. The ratio <span class="math inline">\({a/b}\)</span> controls the skewness of the beta distribution. When the ratio goes further beyond 1, the mean becomes located closer to 1 and the study needs ‘major’ bias adjustment and vice versa.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># jags model: code+data</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">mod3 &lt;-<span class="st"> </span><span class="kw">crosnma.model</span>(<span class="dt">prt.data=</span>prt.data,</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">                   <span class="dt">std.data=</span>std.data,</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">                   <span class="dt">trt=</span><span class="kw">c</span>(<span class="st">'trt'</span>,<span class="st">'trt'</span>),</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">                   <span class="dt">study=</span><span class="kw">c</span>(<span class="st">'study'</span>,<span class="st">'study'</span>),</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">                   <span class="dt">outcome=</span><span class="kw">c</span>(<span class="st">'outcome'</span>,<span class="st">'outcome'</span>),</a>
<a class="sourceLine" id="cb14-7" data-line-number="7">                   <span class="dt">n=</span><span class="st">'n'</span>,</a>
<a class="sourceLine" id="cb14-8" data-line-number="8">                   <span class="dt">design=</span><span class="kw">c</span>(<span class="st">'design'</span>,<span class="st">'design'</span>),</a>
<a class="sourceLine" id="cb14-9" data-line-number="9">                   <span class="dt">reference=</span><span class="st">'A'</span>,</a>
<a class="sourceLine" id="cb14-10" data-line-number="10">                   <span class="dt">trt.effect=</span><span class="st">'random'</span>,</a>
<a class="sourceLine" id="cb14-11" data-line-number="11">                   <span class="co">#----------  meta-regression ---------- </span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12">                   <span class="dt">covariate =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">'age'</span>,<span class="st">'sex'</span>),<span class="kw">c</span>(<span class="st">'age'</span>,<span class="st">'sex'</span>)),</a>
<a class="sourceLine" id="cb14-13" data-line-number="13">                   <span class="co">#---------- bias adjustment ---------- </span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14">                   <span class="dt">method.bias=</span><span class="st">'adjust1'</span>,</a>
<a class="sourceLine" id="cb14-15" data-line-number="15">                   <span class="dt">bias=</span><span class="kw">c</span>(<span class="st">'bias'</span>,<span class="st">'bias'</span>), </a>
<a class="sourceLine" id="cb14-16" data-line-number="16">                   <span class="dt">bias.type=</span><span class="st">'add'</span>,</a>
<a class="sourceLine" id="cb14-17" data-line-number="17">                   <span class="dt">bias.effect=</span><span class="st">'common'</span>,</a>
<a class="sourceLine" id="cb14-18" data-line-number="18">                   <span class="co">#---------- assign a prior ---------- </span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19">                   <span class="dt">prior=</span><span class="kw">list</span>(<span class="dt">tau.trt=</span><span class="st">'dunif(0,3)'</span>,</a>
<a class="sourceLine" id="cb14-20" data-line-number="20">                              <span class="dt">pi.high.rct=</span><span class="st">'dbeta(5,1)'</span>,</a>
<a class="sourceLine" id="cb14-21" data-line-number="21">                              <span class="dt">pi.low.rct=</span><span class="st">'dbeta(1,20)'</span>,</a>
<a class="sourceLine" id="cb14-22" data-line-number="22">                              <span class="dt">pi.high.nrs=</span><span class="st">'dbeta(30,1)'</span>,</a>
<a class="sourceLine" id="cb14-23" data-line-number="23">                              <span class="dt">pi.low.nrs=</span><span class="st">'dbeta(1,2)'</span></a>
<a class="sourceLine" id="cb14-24" data-line-number="24">                                  )</a>
<a class="sourceLine" id="cb14-25" data-line-number="25">                  )</a></code></pre></div>
</div>
<div id="run-jags-2" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Run JAGS</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># run jags</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2">jagsfit3 &lt;-<span class="st"> </span><span class="kw">crosnma.run</span>(<span class="dt">model=</span>mod3,</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">              <span class="dt">n.adapt =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">              <span class="dt">n.iter=</span><span class="dv">50</span>,</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">              <span class="dt">thin=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">              <span class="dt">n.chains=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="co">#&gt; </span><span class="al">NOTE</span><span class="co">: Stopping adaptation</span></a></code></pre></div>
</div>
<div id="output-2" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Output</h3>
<div id="table-of-estimates-2" class="section level4">
<h4><span class="header-section-number">3.3.3.1</span> Table of estimates</h4>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">summary</span>(jagsfit3))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Mean</th>
<th align="right">SD</th>
<th align="right">2.5%</th>
<th align="right">50%</th>
<th align="right">97.5%</th>
<th align="right">Rhat</th>
<th align="right">n.eff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">bb_1</td>
<td align="right">1.0149944</td>
<td align="right">1.0802341</td>
<td align="right">0.9036446</td>
<td align="right">1.0093003</td>
<td align="right">1.1089870</td>
<td align="right">1.206</td>
<td align="right">279</td>
</tr>
<tr class="even">
<td align="left">bb_2</td>
<td align="right">1.4046483</td>
<td align="right">3.2670082</td>
<td align="right">0.0873657</td>
<td align="right">1.6960084</td>
<td align="right">7.3600847</td>
<td align="right">2.618</td>
<td align="right">64</td>
</tr>
<tr class="odd">
<td align="left">bw_1</td>
<td align="right">0.9843439</td>
<td align="right">1.0935765</td>
<td align="right">0.7508205</td>
<td align="right">0.9983559</td>
<td align="right">1.1370412</td>
<td align="right">1.102</td>
<td align="right">162</td>
</tr>
<tr class="even">
<td align="left">bw_2</td>
<td align="right">1.1910232</td>
<td align="right">1.4064071</td>
<td align="right">0.6456951</td>
<td align="right">1.1585237</td>
<td align="right">2.2843591</td>
<td align="right">1.063</td>
<td align="right">191</td>
</tr>
<tr class="odd">
<td align="left">d.A</td>
<td align="right">1.0000000</td>
<td align="right">1.0000000</td>
<td align="right">1.0000000</td>
<td align="right">1.0000000</td>
<td align="right">1.0000000</td>
<td align="right">NaN</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">d.B</td>
<td align="right">0.3298409</td>
<td align="right">2.1585223</td>
<td align="right">0.1193844</td>
<td align="right">0.2814562</td>
<td align="right">1.8001888</td>
<td align="right">2.464</td>
<td align="right">100</td>
</tr>
<tr class="odd">
<td align="left">d.C</td>
<td align="right">0.4895892</td>
<td align="right">2.3064646</td>
<td align="right">0.0847032</td>
<td align="right">0.4787484</td>
<td align="right">1.8379170</td>
<td align="right">2.047</td>
<td align="right">42</td>
</tr>
<tr class="even">
<td align="left">d.D</td>
<td align="right">0.2201683</td>
<td align="right">2.1915952</td>
<td align="right">0.0569739</td>
<td align="right">0.2281997</td>
<td align="right">1.1400230</td>
<td align="right">1.448</td>
<td align="right">26</td>
</tr>
<tr class="odd">
<td align="left">g</td>
<td align="right">0.9403374</td>
<td align="right">3.0059126</td>
<td align="right">0.1532818</td>
<td align="right">1.6641784</td>
<td align="right">2.9966733</td>
<td align="right">8.036</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="left">tau</td>
<td align="right">0.5975229</td>
<td align="right">0.4833882</td>
<td align="right">0.1071308</td>
<td align="right">0.4704254</td>
<td align="right">2.0525110</td>
<td align="right">1.291</td>
<td align="right">27</td>
</tr>
<tr class="odd">
<td align="left">tau.bb_1</td>
<td align="right">0.0870931</td>
<td align="right">0.1730654</td>
<td align="right">0.0040573</td>
<td align="right">0.0384792</td>
<td align="right">0.7774417</td>
<td align="right">1.366</td>
<td align="right">44</td>
</tr>
<tr class="even">
<td align="left">tau.bb_2</td>
<td align="right">0.8921210</td>
<td align="right">0.6440397</td>
<td align="right">0.0227558</td>
<td align="right">0.8634011</td>
<td align="right">1.8898929</td>
<td align="right">2.603</td>
<td align="right">40</td>
</tr>
<tr class="odd">
<td align="left">tau.bw_1</td>
<td align="right">0.0912926</td>
<td align="right">0.1267539</td>
<td align="right">0.0033173</td>
<td align="right">0.0419390</td>
<td align="right">0.5080333</td>
<td align="right">1.163</td>
<td align="right">28</td>
</tr>
<tr class="even">
<td align="left">tau.bw_2</td>
<td align="right">0.4562684</td>
<td align="right">0.4538064</td>
<td align="right">0.0200790</td>
<td align="right">0.3145591</td>
<td align="right">1.6956475</td>
<td align="right">1.038</td>
<td align="right">22</td>
</tr>
</tbody>
</table>
</div>
<div id="plot-of-estimates-2" class="section level4">
<h4><span class="header-section-number">3.3.3.2</span> Plot of estimates</h4>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co"># to be added</span></a></code></pre></div>
</div>
</div>
</div>
<div id="adjusting-for-the-study-specific-bias---method-2" class="section level2">
<h2><span class="header-section-number">3.4</span> Adjusting for the study-specific bias - method 2</h2>
<div id="set-up-jags-model-2" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Set up JAGS model</h3>
<p>The arguments for <code>method.bias='adjust2'</code> are similar to the ones that were used above for <code>method.bias='adjust1'</code>. However, there are two main differences between them. First, in <code>'adjust2'</code>, the relative treatment effects are modeled with a bi-modal normal distribution instead of a univariate normal distribution as in <code>'adjust1'</code> method. Second, we can use a logistic model with a year as a covariate <code>bias.covariate = c('year','year')</code> to estimate the probability of bias in <code>'adjust2'</code>. In <code>'adjust1'</code>, instead we assume a (<span class="math inline">\({Beta(a,b)}\)</span>) to estimate the probability of bias. More details about this method can be found in <span class="citation">(Verde 2020)</span> and in Section 2.2.2 in <span class="citation">(Hamza T 2021)</span>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co"># jags model: code+data</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2">mod4 &lt;-<span class="st"> </span><span class="kw">crosnma.model</span>(<span class="dt">prt.data=</span>prt.data,</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">                   <span class="dt">std.data=</span>std.data,</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">                   <span class="dt">trt=</span><span class="kw">c</span>(<span class="st">'trt'</span>,<span class="st">'trt'</span>),</a>
<a class="sourceLine" id="cb18-5" data-line-number="5">                   <span class="dt">study=</span><span class="kw">c</span>(<span class="st">'study'</span>,<span class="st">'study'</span>),</a>
<a class="sourceLine" id="cb18-6" data-line-number="6">                   <span class="dt">outcome=</span><span class="kw">c</span>(<span class="st">'outcome'</span>,<span class="st">'outcome'</span>),</a>
<a class="sourceLine" id="cb18-7" data-line-number="7">                   <span class="dt">n=</span><span class="st">'n'</span>,</a>
<a class="sourceLine" id="cb18-8" data-line-number="8">                   <span class="dt">design=</span><span class="kw">c</span>(<span class="st">'design'</span>,<span class="st">'design'</span>),</a>
<a class="sourceLine" id="cb18-9" data-line-number="9">                   <span class="dt">reference=</span><span class="st">'A'</span>,</a>
<a class="sourceLine" id="cb18-10" data-line-number="10">                   <span class="dt">trt.effect=</span><span class="st">'random'</span>,</a>
<a class="sourceLine" id="cb18-11" data-line-number="11">                   <span class="co">#----------  meta-regression ----------</span></a>
<a class="sourceLine" id="cb18-12" data-line-number="12">                   <span class="dt">covariate =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">'age'</span>,<span class="st">'sex'</span>),<span class="kw">c</span>(<span class="st">'age'</span>,<span class="st">'sex'</span>)),</a>
<a class="sourceLine" id="cb18-13" data-line-number="13">                   <span class="co">#---------- bias adjustment ----------</span></a>
<a class="sourceLine" id="cb18-14" data-line-number="14">                   <span class="dt">method.bias=</span><span class="st">'adjust1'</span>,</a>
<a class="sourceLine" id="cb18-15" data-line-number="15">                   <span class="dt">bias=</span><span class="kw">c</span>(<span class="st">'bias'</span>,<span class="st">'bias'</span>),</a>
<a class="sourceLine" id="cb18-16" data-line-number="16">                   <span class="dt">bias.type=</span><span class="st">'add'</span>,</a>
<a class="sourceLine" id="cb18-17" data-line-number="17">                   <span class="dt">bias.effect=</span><span class="st">'common'</span>,</a>
<a class="sourceLine" id="cb18-18" data-line-number="18">                   <span class="dt">bias.covariate =</span> <span class="kw">c</span>(<span class="st">'year'</span>,<span class="st">'year'</span>),<span class="co">#</span></a>
<a class="sourceLine" id="cb18-19" data-line-number="19">                   <span class="co">#---------- assign a prior ----------</span></a>
<a class="sourceLine" id="cb18-20" data-line-number="20">                   <span class="dt">prior=</span><span class="kw">list</span>(<span class="dt">tau.trt=</span><span class="st">'dunif(0,3)'</span>,</a>
<a class="sourceLine" id="cb18-21" data-line-number="21">                              <span class="dt">pi.high.rct=</span><span class="st">'dbeta(5,1)'</span>,</a>
<a class="sourceLine" id="cb18-22" data-line-number="22">                              <span class="dt">pi.low.rct=</span><span class="st">'dbeta(1,20)'</span>,</a>
<a class="sourceLine" id="cb18-23" data-line-number="23">                              <span class="dt">pi.high.nrs=</span><span class="st">'dbeta(30,1)'</span>,</a>
<a class="sourceLine" id="cb18-24" data-line-number="24">                              <span class="dt">pi.low.nrs=</span><span class="st">'dbeta(1,2)'</span></a>
<a class="sourceLine" id="cb18-25" data-line-number="25">                   )</a>
<a class="sourceLine" id="cb18-26" data-line-number="26">)</a></code></pre></div>
</div>
<div id="run-jags-3" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Run JAGS</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co"># run jags</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">jagsfit4 &lt;-<span class="st"> </span><span class="kw">crosnma.run</span>(<span class="dt">model=</span>mod4,</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">              <span class="dt">n.adapt =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">              <span class="dt">n.iter=</span><span class="dv">50</span>,</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">              <span class="dt">thin=</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb19-6" data-line-number="6">              <span class="dt">n.chains=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="co">#&gt; </span><span class="al">NOTE</span><span class="co">: Stopping adaptation</span></a></code></pre></div>
</div>
<div id="output-3" class="section level3">
<h3><span class="header-section-number">3.4.3</span> Output</h3>
<div id="table-of-estimates-3" class="section level4">
<h4><span class="header-section-number">3.4.3.1</span> Table of estimates</h4>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">summary</span>(jagsfit4))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Mean</th>
<th align="right">SD</th>
<th align="right">2.5%</th>
<th align="right">50%</th>
<th align="right">97.5%</th>
<th align="right">Rhat</th>
<th align="right">n.eff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">bb_1</td>
<td align="right">0.9679992</td>
<td align="right">1.1431388</td>
<td align="right">0.7751698</td>
<td align="right">0.9794237</td>
<td align="right">1.1425061</td>
<td align="right">1.260</td>
<td align="right">70</td>
</tr>
<tr class="even">
<td align="left">bb_2</td>
<td align="right">2.0866186</td>
<td align="right">3.5835928</td>
<td align="right">0.1703770</td>
<td align="right">2.2315487</td>
<td align="right">33.1593191</td>
<td align="right">1.923</td>
<td align="right">40</td>
</tr>
<tr class="odd">
<td align="left">bw_1</td>
<td align="right">1.0041454</td>
<td align="right">1.0206757</td>
<td align="right">0.9577795</td>
<td align="right">1.0027219</td>
<td align="right">1.0360328</td>
<td align="right">1.298</td>
<td align="right">243</td>
</tr>
<tr class="even">
<td align="left">bw_2</td>
<td align="right">1.0990593</td>
<td align="right">1.4606877</td>
<td align="right">0.4772116</td>
<td align="right">1.1434333</td>
<td align="right">1.9394615</td>
<td align="right">1.014</td>
<td align="right">47</td>
</tr>
<tr class="odd">
<td align="left">d.A</td>
<td align="right">1.0000000</td>
<td align="right">1.0000000</td>
<td align="right">1.0000000</td>
<td align="right">1.0000000</td>
<td align="right">1.0000000</td>
<td align="right">NaN</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">d.B</td>
<td align="right">0.8317712</td>
<td align="right">2.7434388</td>
<td align="right">0.1920233</td>
<td align="right">1.0096004</td>
<td align="right">5.2820599</td>
<td align="right">3.626</td>
<td align="right">65</td>
</tr>
<tr class="odd">
<td align="left">d.C</td>
<td align="right">1.0326455</td>
<td align="right">1.6638243</td>
<td align="right">0.3342912</td>
<td align="right">1.0434069</td>
<td align="right">2.2483561</td>
<td align="right">1.516</td>
<td align="right">38</td>
</tr>
<tr class="even">
<td align="left">d.D</td>
<td align="right">1.5465332</td>
<td align="right">3.0169969</td>
<td align="right">0.3154914</td>
<td align="right">1.9350636</td>
<td align="right">9.6483267</td>
<td align="right">3.593</td>
<td align="right">36</td>
</tr>
<tr class="odd">
<td align="left">g</td>
<td align="right">0.5226258</td>
<td align="right">1.7599339</td>
<td align="right">0.1831695</td>
<td align="right">0.6830860</td>
<td align="right">0.9933255</td>
<td align="right">4.411</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="left">tau</td>
<td align="right">0.4654900</td>
<td align="right">0.3186121</td>
<td align="right">0.1018246</td>
<td align="right">0.3784131</td>
<td align="right">1.2620306</td>
<td align="right">1.246</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td align="left">tau.bb_1</td>
<td align="right">0.1058159</td>
<td align="right">0.2053174</td>
<td align="right">0.0055689</td>
<td align="right">0.0480805</td>
<td align="right">0.5227160</td>
<td align="right">1.432</td>
<td align="right">95</td>
</tr>
<tr class="even">
<td align="left">tau.bb_2</td>
<td align="right">0.9251970</td>
<td align="right">0.5768539</td>
<td align="right">0.0786263</td>
<td align="right">0.8517565</td>
<td align="right">1.8771627</td>
<td align="right">1.013</td>
<td align="right">26</td>
</tr>
<tr class="odd">
<td align="left">tau.bw_1</td>
<td align="right">0.0227366</td>
<td align="right">0.0566854</td>
<td align="right">0.0001317</td>
<td align="right">0.0093378</td>
<td align="right">0.0898430</td>
<td align="right">1.416</td>
<td align="right">33</td>
</tr>
<tr class="even">
<td align="left">tau.bw_2</td>
<td align="right">0.4492233</td>
<td align="right">0.3272656</td>
<td align="right">0.1293640</td>
<td align="right">0.3278839</td>
<td align="right">1.3851953</td>
<td align="right">1.113</td>
<td align="right">26</td>
</tr>
</tbody>
</table>
</div>
<div id="plot-of-estimates-3" class="section level4">
<h4><span class="header-section-number">3.4.3.2</span> Plot of estimates</h4>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># to be added</span></a></code></pre></div>
</div>
</div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-dias_2010">
<p>Dias, Sofia, N. J. Welton, V. C. C. Marinho, G. Salanti, J.P.T Higgins, and A. E. Ades. 2010. “Estimation and Adjustment of Bias in Randomized Evidence by Using Mixed Treatment Comparison Meta-Analysis.” <em>Journal of the Royal Statistical Society</em> 173: 613–29.</p>
</div>
<div id="ref-hamza_2021">
<p>Hamza T, Kuhle J, Pellegrini F. 2021. “Flexible Generic Framework for Evidence Synthesis in Health Technology Assessment.” <em>Unpublished</em>.</p>
</div>
<div id="ref-plummer_jags">
<p>Plummer, Martyn. 2003. “JAGS: A Program for Analysis of Bayesian Graphical Models Using Gibbs Sampling.”</p>
</div>
<div id="ref-verde_2020">
<p>Verde, Pablo Emilio. 2020. “A Bias-Corrected Meta-Analysis Model for Combining, Studies of Different Types and Quality.” <em>Biometrical Journal. Biometrische Zeitschrift</em>, September. <a href="https://doi.org/10.1002/bimj.201900376">https://doi.org/10.1002/bimj.201900376</a>.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
